{"version":3,"file":"discard.spec.js","names":["description","makeTestGroup","ShaderValidationTest","g","test","desc","params","u","combine","fn","t","pos","module","subvert","subfrag","subcomp","vertex","fragment","compute","place","code","pass","includes","expectCompileResult"],"sources":["../../../../../src/webgpu/shader/validation/statement/discard.spec.ts"],"sourcesContent":["export const description = `Validation tests for discard`;\n\nimport { makeTestGroup } from '../../../../common/framework/test_group.js';\nimport { ShaderValidationTest } from '../shader_validation_test.js';\n\nexport const g = makeTestGroup(ShaderValidationTest);\n\ng.test('placement')\n  .desc('Test that discard usage is validated')\n  .params(u =>\n    u.combine('place', ['compute', 'vertex', 'fragment', 'module', 'subfrag', 'subvert', 'subcomp'])\n  )\n  .fn(t => {\n    const pos: { [key: string]: string } = {\n      module: '',\n      subvert: '',\n      subfrag: '',\n      subcomp: '',\n      vertex: '',\n      fragment: '',\n      compute: '',\n    };\n\n    pos[t.params.place] = 'discard;';\n\n    const code = `\n${pos.module}\n\nfn subvert() {\n  ${pos.subvert}\n}\n\n@vertex\nfn vtx() -> @builtin(position) vec4f {\n  ${pos.vertex}\n  subvert();\n  return vec4f(1);\n}\n\nfn subfrag() {\n  ${pos.subfrag}\n}\n\n@fragment\nfn frag() -> @location(0) vec4f {\n  ${pos.fragment}\n  subfrag();\n  return vec4f(1);\n}\n\nfn subcomp() {\n  ${pos.subcomp}\n}\n\n@compute\n@workgroup_size(1)\nfn comp() {\n  ${pos.compute}\n  subcomp();\n}\n`;\n\n    const pass = ['fragment', 'subfrag'].includes(t.params.place);\n    t.expectCompileResult(pass, code);\n  });\n"],"mappings":";;GAAA,OAAO,MAAMA,WAAW,GAAI,8BAA6B,CAEzD,SAASC,aAAa,QAAQ,4CAA4C;AAC1E,SAASC,oBAAoB,QAAQ,8BAA8B;;AAEnE,OAAO,MAAMC,CAAC,GAAGF,aAAa,CAACC,oBAAoB,CAAC;;AAEpDC,CAAC,CAACC,IAAI,CAAC,WAAW,CAAC;AAChBC,IAAI,CAAC,sCAAsC,CAAC;AAC5CC,MAAM,CAAC,CAAAC,CAAC;AACPA,CAAC,CAACC,OAAO,CAAC,OAAO,EAAE,CAAC,SAAS,EAAE,QAAQ,EAAE,UAAU,EAAE,QAAQ,EAAE,SAAS,EAAE,SAAS,EAAE,SAAS,CAAC;AACjG,CAAC;AACAC,EAAE,CAAC,CAAAC,CAAC,KAAI;EACP,MAAMC,GAA8B,GAAG;IACrCC,MAAM,EAAE,EAAE;IACVC,OAAO,EAAE,EAAE;IACXC,OAAO,EAAE,EAAE;IACXC,OAAO,EAAE,EAAE;IACXC,MAAM,EAAE,EAAE;IACVC,QAAQ,EAAE,EAAE;IACZC,OAAO,EAAE;EACX,CAAC;;EAEDP,GAAG,CAACD,CAAC,CAACJ,MAAM,CAACa,KAAK,CAAC,GAAG,UAAU;;EAEhC,MAAMC,IAAI,GAAI;AAClB,EAAET,GAAG,CAACC,MAAO;AACb;AACA;AACA,IAAID,GAAG,CAACE,OAAQ;AAChB;AACA;AACA;AACA;AACA,IAAIF,GAAG,CAACK,MAAO;AACf;AACA;AACA;AACA;AACA;AACA,IAAIL,GAAG,CAACG,OAAQ;AAChB;AACA;AACA;AACA;AACA,IAAIH,GAAG,CAACM,QAAS;AACjB;AACA;AACA;AACA;AACA;AACA,IAAIN,GAAG,CAACI,OAAQ;AAChB;AACA;AACA;AACA;AACA;AACA,IAAIJ,GAAG,CAACO,OAAQ;AAChB;AACA;AACA,CAAC;;EAEG,MAAMG,IAAI,GAAG,CAAC,UAAU,EAAE,SAAS,CAAC,CAACC,QAAQ,CAACZ,CAAC,CAACJ,MAAM,CAACa,KAAK,CAAC;EAC7DT,CAAC,CAACa,mBAAmB,CAACF,IAAI,EAAED,IAAI,CAAC;AACnC,CAAC,CAAC"}