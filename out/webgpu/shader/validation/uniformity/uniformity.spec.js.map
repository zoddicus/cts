{"version":3,"file":"uniformity.spec.js","names":["description","makeTestGroup","unreachable","ShaderValidationTest","g","kCollectiveOps","op","stage","kConditions","cond","expectation","generateCondition","condition","generateOp","generateConditionalStatement","statement","code","test","desc","params","u","combineWithParams","combine","beginSubcases","fn","t","expectCompileResult","kFragmentBuiltinValues","builtin","type","kComputeBuiltinValues","uniform"],"sources":["../../../../../src/webgpu/shader/validation/uniformity/uniformity.spec.ts"],"sourcesContent":["export const description = `Validation tests for uniformity analysis`;\n\nimport { makeTestGroup } from '../../../../common/framework/test_group.js';\nimport { unreachable } from '../../../../common/util/util.js';\nimport { ShaderValidationTest } from '../shader_validation_test.js';\n\nexport const g = makeTestGroup(ShaderValidationTest);\n\nconst kCollectiveOps = [\n  { op: 'textureSample', stage: 'fragment' },\n  { op: 'textureSampleBias', stage: 'fragment' },\n  { op: 'textureSampleCompare', stage: 'fragment' },\n  { op: 'dpdx', stage: 'fragment' },\n  { op: 'dpdxCoarse', stage: 'fragment' },\n  { op: 'dpdxFine', stage: 'fragment' },\n  { op: 'dpdy', stage: 'fragment' },\n  { op: 'dpdyCoarse', stage: 'fragment' },\n  { op: 'dpdyFine', stage: 'fragment' },\n  { op: 'fwidth', stage: 'fragment' },\n  { op: 'fwidthCoarse', stage: 'fragment' },\n  { op: 'fwidthFine', stage: 'fragment' },\n  { op: 'storageBarrier', stage: 'compute' },\n  { op: 'workgroupBarrier', stage: 'compute' },\n  { op: 'workgroupUniformLoad', stage: 'compute' },\n];\n\nconst kConditions = [\n  { cond: 'uniform_storage_ro', expectation: true },\n  { cond: 'nonuniform_storage_ro', expectation: false },\n  { cond: 'nonuniform_storage_rw', expectation: false },\n  { cond: 'nonuniform_builtin', expectation: false },\n  { cond: 'uniform_literal', expectation: true },\n  { cond: 'uniform_const', expectation: true },\n  { cond: 'uniform_override', expectation: true },\n  { cond: 'uniform_let', expectation: true },\n  { cond: 'nonuniform_let', expectation: false },\n  { cond: 'uniform_or', expectation: true },\n  { cond: 'nonuniform_or1', expectation: false },\n  { cond: 'nonuniform_or2', expectation: false },\n  { cond: 'uniform_and', expectation: true },\n  { cond: 'nonuniform_and1', expectation: false },\n  { cond: 'nonuniform_and2', expectation: false },\n  { cond: 'uniform_func_var', expectation: true },\n  { cond: 'nonuniform_func_var', expectation: false },\n];\n\nfunction generateCondition(condition: string): string {\n  switch (condition) {\n    case 'uniform_storage_ro': {\n      return `ro_buffer[0] == 0`;\n    }\n    case 'nonuniform_storage_ro': {\n      return `ro_buffer[priv_var[0]] == 0`;\n    }\n    case 'nonuniform_storage_rw': {\n      return `rw_buffer[0] == 0`;\n    }\n    case 'nonuniform_builtin': {\n      return `p.x == 0`;\n    }\n    case 'uniform_literal': {\n      return `false`;\n    }\n    case 'uniform_const': {\n      return `c`;\n    }\n    case 'uniform_override': {\n      return `o == 0`;\n    }\n    case 'uniform_let': {\n      return `u_let == 0`;\n    }\n    case 'nonuniform_let': {\n      return `n_let == 0`;\n    }\n    case 'uniform_or': {\n      return `u_let == 0 || uniform_buffer.y > 1`;\n    }\n    case 'nonuniform_or1': {\n      return `u_let == 0 || n_let == 0`;\n    }\n    case 'nonuniform_or2': {\n      return `n_let == 0 || u_let == 0`;\n    }\n    case 'uniform_and': {\n      return `u_let == 0 && uniform_buffer.y > 1`;\n    }\n    case 'nonuniform_and1': {\n      return `u_let == 0 && n_let == 0`;\n    }\n    case 'nonuniform_and2': {\n      return `n_let == 0 && u_let == 0`;\n    }\n    case 'uniform_func_var': {\n      return `u_f == 0`;\n    }\n    case 'nonuniform_func_var': {\n      return `n_f == 0`;\n    }\n    default: {\n      unreachable(`Unhandled condition`);\n    }\n  }\n}\n\nfunction generateOp(op: string): string {\n  switch (op) {\n    case 'textureSample': {\n      return `let x = ${op}(tex, s, vec2(0,0));\\n`;\n    }\n    case 'textureSampleBias': {\n      return `let x = ${op}(tex, s, vec2(0,0), 0);\\n`;\n    }\n    case 'textureSampleCompare': {\n      return `let x = ${op}(tex_depth, s_comp, vec2(0,0), 0);\\n`;\n    }\n    case 'storageBarrier':\n    case 'workgroupBarrier': {\n      return `${op}();\\n`;\n    }\n    case 'workgroupUniformLoad': {\n      return `let x = ${op}(&wg);`;\n    }\n    case 'dpdx':\n    case 'dpdxCoarse':\n    case 'dpdxFine':\n    case 'dpdy':\n    case 'dpdyCoarse':\n    case 'dpdyFine':\n    case 'fwidth':\n    case 'fwidthCoarse':\n    case 'fwidthFine': {\n      return `let x = ${op}(0);\\n`;\n    }\n    default: {\n      unreachable(`Unhandled op`);\n    }\n  }\n}\n\nfunction generateConditionalStatement(statement: string, condition: string, op: string): string {\n  const code = ``;\n  switch (statement) {\n    case 'if': {\n      return `if ${generateCondition(condition)} {\n        ${generateOp(op)};\n      }\n      `;\n    }\n    case 'for': {\n      return `for (; ${generateCondition(condition)};) {\n        ${generateOp(op)};\n      }\n      `;\n    }\n    case 'while': {\n      return `while ${generateCondition(condition)} {\n        ${generateOp(op)};\n      }\n      `;\n    }\n    case 'switch': {\n      return `switch u32(${generateCondition(condition)}) {\n        case 0: {\n          ${generateOp(op)};\n        }\n        default: { }\n      }\n      `;\n    }\n    default: {\n      unreachable(`Unhandled statement`);\n    }\n  }\n\n  return code;\n}\n\ng.test('basics')\n  .desc(`Test collective operations in simple uniform or non-uniform control flow.`)\n  .params(u =>\n    u\n      .combineWithParams(kCollectiveOps)\n      .combineWithParams(kConditions)\n      .combine('statement', ['if', 'for', 'while', 'switch'] as const)\n      .beginSubcases()\n  )\n  .fn(t => {\n    let code = `\n @group(0) @binding(0) var s : sampler;\n @group(0) @binding(1) var s_comp : sampler_comparison;\n @group(0) @binding(2) var tex : texture_2d<f32>;\n @group(0) @binding(3) var tex_depth : texture_depth_2d;\n\n @group(1) @binding(0) var<storage, read> ro_buffer : array<f32, 4>;\n @group(1) @binding(1) var<storage, read_write> rw_buffer : array<f32, 4>;\n @group(1) @binding(2) var<uniform> uniform_buffer : vec4<f32>;\n\n var<private> priv_var : array<f32, 4> = array(0,0,0,0);\n\n const c = false;\n override o : f32;\n`;\n\n    if (t.params.stage === 'compute') {\n      code += `var<workgroup> wg : f32;\\n`;\n      code += ` @workgroup_size(16, 1, 1)`;\n    }\n    code += `@${t.params.stage}`;\n    code += `\\nfn main(`;\n    if (t.params.stage === 'compute') {\n      code += `@builtin(global_invocation_id) p : vec3<u32>`;\n    } else {\n      code += `@builtin(position) p : vec4<f32>`;\n    }\n    code += `) {\n      let u_let = uniform_buffer.x;\n      let n_let = rw_buffer[0];\n      var u_f = uniform_buffer.z;\n      var n_f = rw_buffer[1];\n    `;\n\n    // Simple control statement containing the op.\n    code += generateConditionalStatement(t.params.statement, t.params.cond, t.params.op);\n\n    code += `\\n}\\n`;\n\n    t.expectCompileResult(t.params.expectation, code);\n  });\n\nconst kFragmentBuiltinValues = [\n  {\n    builtin: `position`,\n    type: `vec4<f32>`,\n  },\n  {\n    builtin: `front_facing`,\n    type: `bool`,\n  },\n  {\n    builtin: `sample_index`,\n    type: `u32`,\n  },\n  {\n    builtin: `sample_mask`,\n    type: `u32`,\n  },\n];\n\ng.test('fragment_builtin_values')\n  .desc(`Test uniformity of fragment built-in values`)\n  .params(u => u.combineWithParams(kFragmentBuiltinValues).beginSubcases())\n  .fn(t => {\n    let cond = ``;\n    switch (t.params.type) {\n      case `u32`:\n      case `i32`:\n      case `f32`: {\n        cond = `p > 0`;\n        break;\n      }\n      case `vec4<u32>`:\n      case `vec4<i32>`:\n      case `vec4<f32>`: {\n        cond = `p.x > 0`;\n        break;\n      }\n      case `bool`: {\n        cond = `p`;\n        break;\n      }\n      default: {\n        unreachable(`Unhandled type`);\n      }\n    }\n    const code = `\n@group(0) @binding(0) var s : sampler;\n@group(0) @binding(1) var tex : texture_2d<f32>;\n\n@fragment\nfn main(@builtin(${t.params.builtin}) p : ${t.params.type}) {\n  if ${cond} {\n    let texel = textureSample(tex, s, vec2<f32>(0,0));\n  }\n}\n`;\n\n    t.expectCompileResult(true, `diagnostic(off, derivative_uniformity);\\n` + code);\n    t.expectCompileResult(false, code);\n  });\n\nconst kComputeBuiltinValues = [\n  {\n    builtin: `local_invocation_id`,\n    type: `vec3<f32>`,\n    uniform: false,\n  },\n  {\n    builtin: `local_invocation_index`,\n    type: `u32`,\n    uniform: false,\n  },\n  {\n    builtin: `global_invocation_id`,\n    type: `vec3<u32>`,\n    uniform: false,\n  },\n  {\n    builtin: `workgroup_id`,\n    type: `vec3<u32>`,\n    uniform: true,\n  },\n  {\n    builtin: `num_workgroups`,\n    type: `vec3<u32>`,\n    uniform: true,\n  },\n];\n\ng.test('compute_builtin_values')\n  .desc(`Test uniformity of compute built-in values`)\n  .params(u => u.combineWithParams(kComputeBuiltinValues).beginSubcases())\n  .fn(t => {\n    let cond = ``;\n    switch (t.params.type) {\n      case `u32`:\n      case `i32`:\n      case `f32`: {\n        cond = `p > 0`;\n        break;\n      }\n      case `vec3<u32>`:\n      case `vec3<i32>`:\n      case `vec3<f32>`: {\n        cond = `p.x > 0`;\n        break;\n      }\n      case `bool`: {\n        cond = `p`;\n        break;\n      }\n      default: {\n        unreachable(`Unhandled type`);\n      }\n    }\n    const code = `\n@compute @workgroup_size(16,1,1)\nfn main(@builtin(${t.params.builtin}) p : ${t.params.type}) {\n  if ${cond} {\n    workgroupBarrier();\n  }\n}\n`;\n\n    t.expectCompileResult(t.params.uniform, code);\n  });\n"],"mappings":"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"}