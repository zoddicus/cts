{"version":3,"file":"alias.spec.js","names":["description","makeTestGroup","ShaderValidationTest","g","test","desc","params","u","combine","fn","t","wgsl","target","expectCompileResult","attribute"],"sources":["../../../../../src/webgpu/shader/validation/types/alias.spec.ts"],"sourcesContent":["export const description = `\nValidation tests for type aliases\n`;\n\nimport { makeTestGroup } from '../../../../common/framework/test_group.js';\nimport { ShaderValidationTest } from '../shader_validation_test.js';\n\nexport const g = makeTestGroup(ShaderValidationTest);\n\ng.test('no_direct_recursion')\n  .desc('Test that direct recursion of type aliases is rejected')\n  .params(u => u.combine('target', ['i32', 'T']))\n  .fn(t => {\n    const wgsl = `alias T = ${t.params.target};`;\n    t.expectCompileResult(t.params.target === 'i32', wgsl);\n  });\n\ng.test('no_indirect_recursion')\n  .desc('Test that indirect recursion of type aliases is rejected')\n  .params(u => u.combine('target', ['i32', 'S']))\n  .fn(t => {\n    const wgsl = `\nalias S = T;\nalias T = ${t.params.target};\n`;\n    t.expectCompileResult(t.params.target === 'i32', wgsl);\n  });\n\ng.test('no_indirect_recursion_via_vector_element')\n  .desc('Test that indirect recursion of type aliases via vector element types is rejected')\n  .params(u => u.combine('target', ['i32', 'V']))\n  .fn(t => {\n    const wgsl = `\nalias V = vec4<T>;\nalias T = ${t.params.target};\n`;\n    t.expectCompileResult(t.params.target === 'i32', wgsl);\n  });\n\ng.test('no_indirect_recursion_via_matrix_element')\n  .desc('Test that indirect recursion of type aliases via matrix element types is rejected')\n  .params(u => u.combine('target', ['f32', 'M']))\n  .fn(t => {\n    const wgsl = `\nalias M = mat4x4<T>;\nalias T = ${t.params.target};\n`;\n    t.expectCompileResult(t.params.target === 'f32', wgsl);\n  });\n\ng.test('no_indirect_recursion_via_array_element')\n  .desc('Test that indirect recursion of type aliases via array element types is rejected')\n  .params(u => u.combine('target', ['i32', 'A']))\n  .fn(t => {\n    const wgsl = `\nalias A = array<T, 4>;\nalias T = ${t.params.target};\n`;\n    t.expectCompileResult(t.params.target === 'i32', wgsl);\n  });\n\ng.test('no_indirect_recursion_via_array_size')\n  .desc('Test that indirect recursion of type aliases via array size expressions is rejected')\n  .params(u => u.combine('target', ['i32', 'A']))\n  .fn(t => {\n    const wgsl = `\nalias A = array<i32, T(1)>;\nalias T = ${t.params.target};\n`;\n    t.expectCompileResult(t.params.target === 'i32', wgsl);\n  });\n\ng.test('no_indirect_recursion_via_atomic')\n  .desc('Test that indirect recursion of type aliases via atomic types is rejected')\n  .params(u => u.combine('target', ['i32', 'A']))\n  .fn(t => {\n    const wgsl = `\nalias A = atomic<T>;\nalias T = ${t.params.target};\n`;\n    t.expectCompileResult(t.params.target === 'i32', wgsl);\n  });\n\ng.test('no_indirect_recursion_via_ptr_store_type')\n  .desc('Test that indirect recursion of type aliases via pointer store types is rejected')\n  .params(u => u.combine('target', ['i32', 'P']))\n  .fn(t => {\n    const wgsl = `\nalias P = ptr<function, T>;\nalias T = ${t.params.target};\n`;\n    t.expectCompileResult(t.params.target === 'i32', wgsl);\n  });\n\ng.test('no_indirect_recursion_via_struct_member')\n  .desc('Test that indirect recursion of type aliases via struct members is rejected')\n  .params(u => u.combine('target', ['i32', 'S']))\n  .fn(t => {\n    const wgsl = `\nstruct S {\n  a : T\n}\nalias T = ${t.params.target};\n`;\n    t.expectCompileResult(t.params.target === 'i32', wgsl);\n  });\n\ng.test('no_indirect_recursion_via_struct_attribute')\n  .desc('Test that indirect recursion of type aliases via struct members is rejected')\n  .params(u =>\n    u //\n      .combine('target', ['i32', 'S'])\n      .combine('attribute', ['align', 'location', 'size'])\n  )\n  .fn(t => {\n    const wgsl = `\nstruct S {\n  @${t.params.attribute}(T(4)) a : f32\n}\nalias T = ${t.params.target};\n`;\n    t.expectCompileResult(t.params.target === 'i32', wgsl);\n  });\n"],"mappings":"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"}