{"version":3,"file":"return.spec.js","names":["description","makeTestGroup","keysOf","ShaderValidationTest","g","kTests","no_expr","wgsl","pass_value","pass_no_value","v","literal","expr","paren_expr","call","v_no_semicolon","expr_no_semicolon","phony_assign","increment","compound_assign","lparen_literal","literal_lparen","rparen_literal","literal_rparen","lparen_literal_lparen","rparen_literal_rparen","test","desc","params","u","combine","fn","t","code","fn_returns_value","expectCompileResult"],"sources":["../../../../../src/webgpu/shader/validation/parse/return.spec.ts"],"sourcesContent":["export const description = `Validation parser tests for 'return' statements`;\n\nimport { makeTestGroup } from '../../../../common/framework/test_group.js';\nimport { keysOf } from '../../../../common/util/data_tables.js';\nimport { ShaderValidationTest } from '../shader_validation_test.js';\n\nexport const g = makeTestGroup(ShaderValidationTest);\n\nconst kTests = {\n  no_expr: { wgsl: `return;`, pass_value: false, pass_no_value: true },\n  v: { wgsl: `return v;`, pass_value: true, pass_no_value: false },\n  literal: { wgsl: `return 10;`, pass_value: true, pass_no_value: false },\n  expr: { wgsl: `return 1 + 2;`, pass_value: true, pass_no_value: false },\n  paren_expr: { wgsl: `return (1 + 2);`, pass_value: true, pass_no_value: false },\n  call: { wgsl: `return x();`, pass_value: true, pass_no_value: false },\n\n  v_no_semicolon: { wgsl: `return v`, pass_value: false, pass_no_value: false },\n  expr_no_semicolon: { wgsl: `return 1 + 2`, pass_value: false, pass_no_value: false },\n  phony_assign: { wgsl: `return _ = 1;`, pass_value: false, pass_no_value: false },\n  increment: { wgsl: `return v++;`, pass_value: false, pass_no_value: false },\n  compound_assign: { wgsl: `return v += 4;`, pass_value: false, pass_no_value: false },\n  lparen_literal: { wgsl: `return (4;`, pass_value: false, pass_no_value: false },\n  literal_lparen: { wgsl: `return 4(;`, pass_value: false, pass_no_value: false },\n  rparen_literal: { wgsl: `return )4;`, pass_value: false, pass_no_value: false },\n  literal_rparen: { wgsl: `return 4);`, pass_value: false, pass_no_value: false },\n  lparen_literal_lparen: { wgsl: `return (4(;`, pass_value: false, pass_no_value: false },\n  rparen_literal_rparen: { wgsl: `return )4);`, pass_value: false, pass_no_value: false },\n};\n\ng.test('parse')\n  .desc(`Test that 'return' statements are parsed correctly.`)\n  .params(u =>\n    u.combine('test', keysOf(kTests)).combine('fn_returns_value', [false, true] as const)\n  )\n  .fn(t => {\n    const code = `\nfn f() ${t.params.fn_returns_value ? '-> i32' : ''} {\n  let v = 42;\n  ${kTests[t.params.test].wgsl}\n}\nfn x() -> i32 {\n  return 1;\n}\n`;\n    t.expectCompileResult(\n      t.params.fn_returns_value\n        ? kTests[t.params.test].pass_value\n        : kTests[t.params.test].pass_no_value,\n      code\n    );\n  });\n"],"mappings":"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"}