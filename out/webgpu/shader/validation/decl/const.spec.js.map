{"version":3,"file":"const.spec.js","names":["description","makeTestGroup","ShaderValidationTest","g","test","desc","params","u","combine","fn","t","wgsl","target","expectCompileResult","attribute"],"sources":["../../../../../src/webgpu/shader/validation/decl/const.spec.ts"],"sourcesContent":["export const description = `\nValidation tests for const declarations\n`;\n\nimport { makeTestGroup } from '../../../../common/framework/test_group.js';\nimport { ShaderValidationTest } from '../shader_validation_test.js';\n\nexport const g = makeTestGroup(ShaderValidationTest);\n\ng.test('no_direct_recursion')\n  .desc('Test that direct recursion of const declarations is rejected')\n  .params(u => u.combine('target', ['a', 'b']))\n  .fn(t => {\n    const wgsl = `\nconst a : i32 = 42;\nconst b : i32 = ${t.params.target};\n`;\n    t.expectCompileResult(t.params.target === 'a', wgsl);\n  });\n\ng.test('no_indirect_recursion')\n  .desc('Test that indirect recursion of const declarations is rejected')\n  .params(u => u.combine('target', ['a', 'b']))\n  .fn(t => {\n    const wgsl = `\nconst a : i32 = 42;\nconst b : i32 = c;\nconst c : i32 = ${t.params.target};\n`;\n    t.expectCompileResult(t.params.target === 'a', wgsl);\n  });\n\ng.test('no_indirect_recursion_via_array_size')\n  .desc('Test that indirect recursion of const declarations via array size expressions is rejected')\n  .params(u => u.combine('target', ['a', 'b']))\n  .fn(t => {\n    const wgsl = `\nconst a = 4;\nconst b = c[0];\nconst c = array<i32, ${t.params.target}>(4, 4, 4, 4);\n`;\n    t.expectCompileResult(t.params.target === 'a', wgsl);\n  });\n\ng.test('no_indirect_recursion_via_struct_attribute')\n  .desc('Test that indirect recursion of const declarations via struct members is rejected')\n  .params(u =>\n    u //\n      .combine('target', ['a', 'b'])\n      .combine('attribute', ['align', 'location', 'size'])\n  )\n  .fn(t => {\n    const wgsl = `\nstruct S {\n  @${t.params.attribute}(${t.params.target}) a : i32\n}\nconst a = 4;\nconst b = S(4).a;\n`;\n    t.expectCompileResult(t.params.target === 'a', wgsl);\n  });\n"],"mappings":";;GAAA,OAAO,MAAMA,WAAW,GAAI;AAC5B;AACA,CAAC,CAED,SAASC,aAAa,QAAQ,4CAA4C;AAC1E,SAASC,oBAAoB,QAAQ,8BAA8B;;AAEnE,OAAO,MAAMC,CAAC,GAAGF,aAAa,CAACC,oBAAoB,CAAC;;AAEpDC,CAAC,CAACC,IAAI,CAAC,qBAAqB,CAAC;AAC1BC,IAAI,CAAC,8DAA8D,CAAC;AACpEC,MAAM,CAAC,CAAAC,CAAC,KAAIA,CAAC,CAACC,OAAO,CAAC,QAAQ,EAAE,CAAC,GAAG,EAAE,GAAG,CAAC,CAAC,CAAC;AAC5CC,EAAE,CAAC,CAAAC,CAAC,KAAI;EACP,MAAMC,IAAI,GAAI;AAClB;AACA,kBAAkBD,CAAC,CAACJ,MAAM,CAACM,MAAO;AAClC,CAAC;EACGF,CAAC,CAACG,mBAAmB,CAACH,CAAC,CAACJ,MAAM,CAACM,MAAM,KAAK,GAAG,EAAED,IAAI,CAAC;AACtD,CAAC,CAAC;;AAEJR,CAAC,CAACC,IAAI,CAAC,uBAAuB,CAAC;AAC5BC,IAAI,CAAC,gEAAgE,CAAC;AACtEC,MAAM,CAAC,CAAAC,CAAC,KAAIA,CAAC,CAACC,OAAO,CAAC,QAAQ,EAAE,CAAC,GAAG,EAAE,GAAG,CAAC,CAAC,CAAC;AAC5CC,EAAE,CAAC,CAAAC,CAAC,KAAI;EACP,MAAMC,IAAI,GAAI;AAClB;AACA;AACA,kBAAkBD,CAAC,CAACJ,MAAM,CAACM,MAAO;AAClC,CAAC;EACGF,CAAC,CAACG,mBAAmB,CAACH,CAAC,CAACJ,MAAM,CAACM,MAAM,KAAK,GAAG,EAAED,IAAI,CAAC;AACtD,CAAC,CAAC;;AAEJR,CAAC,CAACC,IAAI,CAAC,sCAAsC,CAAC;AAC3CC,IAAI,CAAC,2FAA2F,CAAC;AACjGC,MAAM,CAAC,CAAAC,CAAC,KAAIA,CAAC,CAACC,OAAO,CAAC,QAAQ,EAAE,CAAC,GAAG,EAAE,GAAG,CAAC,CAAC,CAAC;AAC5CC,EAAE,CAAC,CAAAC,CAAC,KAAI;EACP,MAAMC,IAAI,GAAI;AAClB;AACA;AACA,uBAAuBD,CAAC,CAACJ,MAAM,CAACM,MAAO;AACvC,CAAC;EACGF,CAAC,CAACG,mBAAmB,CAACH,CAAC,CAACJ,MAAM,CAACM,MAAM,KAAK,GAAG,EAAED,IAAI,CAAC;AACtD,CAAC,CAAC;;AAEJR,CAAC,CAACC,IAAI,CAAC,4CAA4C,CAAC;AACjDC,IAAI,CAAC,mFAAmF,CAAC;AACzFC,MAAM,CAAC,CAAAC,CAAC;AACPA,CAAC,CAAC;AAAA,CACCC,OAAO,CAAC,QAAQ,EAAE,CAAC,GAAG,EAAE,GAAG,CAAC,CAAC;AAC7BA,OAAO,CAAC,WAAW,EAAE,CAAC,OAAO,EAAE,UAAU,EAAE,MAAM,CAAC;AACvD,CAAC;AACAC,EAAE,CAAC,CAAAC,CAAC,KAAI;EACP,MAAMC,IAAI,GAAI;AAClB;AACA,KAAKD,CAAC,CAACJ,MAAM,CAACQ,SAAU,IAAGJ,CAAC,CAACJ,MAAM,CAACM,MAAO;AAC3C;AACA;AACA;AACA,CAAC;EACGF,CAAC,CAACG,mBAAmB,CAACH,CAAC,CAACJ,MAAM,CAACM,MAAM,KAAK,GAAG,EAAED,IAAI,CAAC;AACtD,CAAC,CAAC"}