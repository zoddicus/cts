{"version":3,"file":"textureLoad.spec.js","names":["description","makeTestGroup","unreachable","iterRange","isCompressedFloatTextureFormat","isDepthTextureFormat","kCompressedTextureFormats","kEncodableTextureFormats","kTextureFormatInfo","textureDimensionAndFormatCompatible","GPUTest","kFloat32Format","kFloat16Format","numberToFloatBits","pack4x8unorm","pack4x8snorm","maxMipLevelCount","TexelFormats","checkCallResults","chooseTextureSize","createTextureWithRandomDataAndGetTexels","doTextureCalls","appendComponentTypeForFormatToTextureType","generateCoordBoundaries","getCoordinateForBoundaries","getLayerFromLayerSpec","getMipLevelFromLevelSpec","isBoundaryNegative","isLayerSpecNegative","isLevelSpecNegative","kTestableColorFormats","filterOutDepthAndCompressedFloatTextureFormats","format","filterOutU32WithNegativeValues","t","C","level","coordsBoundary","array_index","g","test","specURL","desc","params","u","combine","filter","blockHeight","beginSubcases","beforeAllSubcases","skipIfTextureFormatNotSupported","selectDeviceForTextureFormatOrSkipTestCase","fn","L","width","minSize","minBlocks","size","descriptor","dimension","usage","GPUTextureUsage","COPY_DST","TEXTURE_BINDING","texels","texture","mipLevel","mipLevelCount","coords","calls","builtin","coordType","levelType","textureType","viewDescriptor","sampler","undefined","results","res","expectOK","viewDimension","unimplemented","paramsSubcasesOnly","texture_type","A","arrayIndex","depthOrArrayLayers","arrayIndexType","shaderValues","type","r","b","a","combineWithParams","_shaderType","skipIf","hasLanguageFeature","selectDeviceOrSkipTestCase","skipIfTextureFormatNotUsableAsStorageTexture","values","useType","assignValue","wgsl","length","bytesPerRow","bytesPerTexel","textureSize","height","createTextureTracked","STORAGE_BINDING","outputBuffer","makeBufferWithContents","Uint32Array","x","GPUBufferUsage","COPY_SRC","STORAGE","trackForCleanup","transformed","flatMap","texelBuffer","pipeline","device","createComputePipeline","layout","compute","module","createShaderModule","code","entryPoint","bg","createBindGroup","getBindGroupLayout","entries","binding","resource","createView","buffer","encoder","createCommandEncoder","copyBufferToTexture","offset","rowsPerImage","pass","beginComputePass","setPipeline","setBindGroup","dispatchWorkgroups","end","queue","submit","finish","expected","expectGPUBufferValuesEqual"],"sources":["../../../../../../../src/webgpu/shader/execution/expression/call/builtin/textureLoad.spec.ts"],"sourcesContent":["export const description = `\nExecution tests for the 'textureLoad' builtin function\n\nReads a single texel from a texture without sampling or filtering.\n\nReturns the unfiltered texel data.\n\nAn out of bounds access occurs if:\n * any element of coords is outside the range [0, textureDimensions(t, level)) for the corresponding element, or\n * array_index is outside the range [0, textureNumLayers(t)), or\n * level is outside the range [0, textureNumLevels(t))\n\nIf an out of bounds access occurs, the built-in function returns one of:\n * The data for some texel within bounds of the texture\n * A vector (0,0,0,0) or (0,0,0,1) of the appropriate type for non-depth textures\n * 0.0 for depth textures\n\nTODO: Test textureLoad with depth textures as texture_2d, etc...\n`;\n\nimport { makeTestGroup } from '../../../../../../common/framework/test_group.js';\nimport { unreachable, iterRange } from '../../../../../../common/util/util.js';\nimport {\n  isCompressedFloatTextureFormat,\n  isDepthTextureFormat,\n  kCompressedTextureFormats,\n  kEncodableTextureFormats,\n  kTextureFormatInfo,\n  textureDimensionAndFormatCompatible,\n} from '../../../../../format_info.js';\nimport { GPUTest } from '../../../../../gpu_test.js';\nimport {\n  kFloat32Format,\n  kFloat16Format,\n  numberToFloatBits,\n  pack4x8unorm,\n  pack4x8snorm,\n} from '../../../../../util/conversion.js';\nimport { maxMipLevelCount } from '../../../../../util/texture/base.js';\nimport { TexelFormats } from '../../../../types.js';\n\nimport {\n  TextureCall,\n  checkCallResults,\n  chooseTextureSize,\n  createTextureWithRandomDataAndGetTexels,\n  doTextureCalls,\n  appendComponentTypeForFormatToTextureType,\n  vec2,\n  vec1,\n  vec3,\n} from './texture_utils.js';\nimport {\n  Boundary,\n  LayerSpec,\n  LevelSpec,\n  generateCoordBoundaries,\n  getCoordinateForBoundaries,\n  getLayerFromLayerSpec,\n  getMipLevelFromLevelSpec,\n  isBoundaryNegative,\n  isLayerSpecNegative,\n  isLevelSpecNegative,\n} from './utils.js';\n\nconst kTestableColorFormats = [...kEncodableTextureFormats, ...kCompressedTextureFormats] as const;\n\nfunction filterOutDepthAndCompressedFloatTextureFormats({ format }: { format: GPUTextureFormat }) {\n  return !isDepthTextureFormat(format) && !isCompressedFloatTextureFormat(format);\n}\n\nfunction filterOutU32WithNegativeValues(t: {\n  C: 'i32' | 'u32';\n  level: LevelSpec;\n  coordsBoundary: Boundary;\n  array_index?: LayerSpec;\n}) {\n  return (\n    t.C === 'i32' ||\n    (!isLevelSpecNegative(t.level) &&\n      !isBoundaryNegative(t.coordsBoundary) &&\n      !isLayerSpecNegative(t.array_index ?? 0))\n  );\n}\n\nexport const g = makeTestGroup(GPUTest);\n\ng.test('sampled_1d')\n  .specURL('https://www.w3.org/TR/WGSL/#textureload')\n  .desc(\n    `\nC is i32 or u32\n\nfn textureLoad(t: texture_1d<T>, coords: C, level: C) -> vec4<T>\n\nParameters:\n * t: The sampled texture to read from\n * coords: The 0-based texel coordinate\n * level: The mip level, with level 0 containing a full size version of the texture\n`\n  )\n  .params(u =>\n    u\n      .combine('format', kTestableColorFormats)\n      .filter(t => textureDimensionAndFormatCompatible('1d', t.format))\n      // 1d textures can't have a height !== 1\n      .filter(t => kTextureFormatInfo[t.format].blockHeight === 1)\n      .beginSubcases()\n      .combine('C', ['i32', 'u32'] as const)\n      .combine('L', ['i32', 'u32'] as const)\n      .combine('coordsBoundary', generateCoordBoundaries(1))\n      .combine('level', [-1, 0, `numLevels-1`, `numLevels`] as const)\n      // Only test level out of bounds if coordBoundary is in-bounds\n      .filter(t => !(t.level !== 0 && t.coordsBoundary !== 'in-bounds'))\n      .filter(filterOutU32WithNegativeValues)\n  )\n  .beforeAllSubcases(t => {\n    const { format } = t.params;\n    t.skipIfTextureFormatNotSupported(format);\n    t.selectDeviceForTextureFormatOrSkipTestCase(t.params.format);\n  })\n  .fn(async t => {\n    const { format, C, L, coordsBoundary, level } = t.params;\n\n    // We want at least 4 blocks or something wide enough for 3 mip levels.\n    const [width] = chooseTextureSize({ minSize: 8, minBlocks: 4, format });\n    const size = [width, 1];\n\n    const descriptor: GPUTextureDescriptor = {\n      format,\n      dimension: '1d',\n      size,\n      usage: GPUTextureUsage.COPY_DST | GPUTextureUsage.TEXTURE_BINDING,\n    };\n    const { texels, texture } = await createTextureWithRandomDataAndGetTexels(t, descriptor);\n    const mipLevel = getMipLevelFromLevelSpec(texture.mipLevelCount, level);\n    const coords = getCoordinateForBoundaries<vec1>(texture, mipLevel, coordsBoundary);\n\n    const calls: TextureCall<vec1>[] = [\n      {\n        builtin: 'textureLoad',\n        coordType: C === 'i32' ? 'i' : 'u',\n        levelType: L === 'i32' ? 'i' : 'u',\n        mipLevel,\n        coords,\n      },\n    ];\n    const textureType = appendComponentTypeForFormatToTextureType('texture_1d', texture.format);\n    const viewDescriptor = {};\n    const sampler = undefined;\n    const results = await doTextureCalls(t, texture, viewDescriptor, textureType, sampler, calls);\n    const res = await checkCallResults(\n      t,\n      { texels, descriptor, viewDescriptor },\n      textureType,\n      sampler,\n      calls,\n      results\n    );\n    t.expectOK(res);\n  });\n\ng.test('sampled_2d')\n  .specURL('https://www.w3.org/TR/WGSL/#textureload')\n  .desc(\n    `\nC is i32 or u32\nL is i32 or u32\n\nfn textureLoad(t: texture_2d<T>, coords: vec2<C>, level: L) -> vec4<T>\n\nParameters:\n * t: The sampled texture to read from\n * coords: The 0-based texel coordinate\n * level: The mip level, with level 0 containing a full size version of the texture\n`\n  )\n  .params(u =>\n    u\n      .combine('format', kTestableColorFormats)\n      .filter(filterOutDepthAndCompressedFloatTextureFormats)\n      .beginSubcases()\n      .combine('C', ['i32', 'u32'] as const)\n      .combine('L', ['i32', 'u32'] as const)\n      .combine('coordsBoundary', generateCoordBoundaries(2))\n      .combine('level', [-1, 0, `numLevels-1`, `numLevels`] as const)\n      // Only test level out of bounds if coordBoundary is in-bounds\n      .filter(t => !(t.level !== 0 && t.coordsBoundary !== 'in-bounds'))\n      .filter(filterOutU32WithNegativeValues)\n  )\n  .beforeAllSubcases(t => {\n    const { format } = t.params;\n    t.skipIfTextureFormatNotSupported(format);\n    t.selectDeviceForTextureFormatOrSkipTestCase(t.params.format);\n  })\n  .fn(async t => {\n    const { format, C, L, coordsBoundary, level } = t.params;\n\n    // We want at least 4 blocks or something wide enough for 3 mip levels.\n    const size = chooseTextureSize({ minSize: 8, minBlocks: 4, format });\n\n    const descriptor: GPUTextureDescriptor = {\n      format,\n      size,\n      usage: GPUTextureUsage.COPY_DST | GPUTextureUsage.TEXTURE_BINDING,\n      mipLevelCount: maxMipLevelCount({ size }),\n    };\n    const { texels, texture } = await createTextureWithRandomDataAndGetTexels(t, descriptor);\n    const mipLevel = getMipLevelFromLevelSpec(texture.mipLevelCount, level);\n    const coords = getCoordinateForBoundaries<vec2>(texture, mipLevel, coordsBoundary);\n\n    const calls: TextureCall<vec2>[] = [\n      {\n        builtin: 'textureLoad',\n        coordType: C === 'i32' ? 'i' : 'u',\n        levelType: L === 'i32' ? 'i' : 'u',\n        mipLevel,\n        coords,\n      },\n    ];\n    const textureType = appendComponentTypeForFormatToTextureType('texture_2d', texture.format);\n    const viewDescriptor = {};\n    const sampler = undefined;\n    const results = await doTextureCalls(t, texture, viewDescriptor, textureType, sampler, calls);\n    const res = await checkCallResults(\n      t,\n      { texels, descriptor, viewDescriptor },\n      textureType,\n      sampler,\n      calls,\n      results\n    );\n    t.expectOK(res);\n  });\n\ng.test('sampled_3d')\n  .specURL('https://www.w3.org/TR/WGSL/#textureload')\n  .desc(\n    `\nC is i32 or u32\n\nfn textureLoad(t: texture_3d<T>, coords: vec3<C>, level: C) -> vec4<T>\n\nParameters:\n * t: The sampled texture to read from\n * coords: The 0-based texel coordinate\n * level: The mip level, with level 0 containing a full size version of the texture\n`\n  )\n  .params(u =>\n    u\n      .combine('format', kTestableColorFormats)\n      .filter(t => textureDimensionAndFormatCompatible('3d', t.format))\n      .beginSubcases()\n      .combine('C', ['i32', 'u32'] as const)\n      .combine('L', ['i32', 'u32'] as const)\n      .combine('coordsBoundary', generateCoordBoundaries(3))\n      .combine('level', [-1, 0, `numLevels-1`, `numLevels`] as const)\n      // Only test level out of bounds if coordBoundary is in-bounds\n      .filter(t => !(t.level !== 0 && t.coordsBoundary !== 'in-bounds'))\n      .filter(filterOutU32WithNegativeValues)\n  )\n  .beforeAllSubcases(t => {\n    const { format } = t.params;\n    t.skipIfTextureFormatNotSupported(format);\n    t.selectDeviceForTextureFormatOrSkipTestCase(t.params.format);\n  })\n  .fn(async t => {\n    const { format, C, L, coordsBoundary, level } = t.params;\n\n    // We want at least 4 blocks or something wide enough for 3 mip levels.\n    const size = chooseTextureSize({ minSize: 8, minBlocks: 4, format, viewDimension: '3d' });\n\n    const descriptor: GPUTextureDescriptor = {\n      format,\n      dimension: '3d',\n      size,\n      usage: GPUTextureUsage.COPY_DST | GPUTextureUsage.TEXTURE_BINDING,\n      mipLevelCount: maxMipLevelCount({ size }),\n    };\n    const { texels, texture } = await createTextureWithRandomDataAndGetTexels(t, descriptor);\n    const mipLevel = getMipLevelFromLevelSpec(texture.mipLevelCount, level);\n    const coords = getCoordinateForBoundaries<vec3>(texture, mipLevel, coordsBoundary);\n\n    const calls: TextureCall<vec3>[] = [\n      {\n        builtin: 'textureLoad',\n        coordType: C === 'i32' ? 'i' : 'u',\n        levelType: L === 'i32' ? 'i' : 'u',\n        mipLevel,\n        coords,\n      },\n    ];\n    const textureType = appendComponentTypeForFormatToTextureType('texture_3d', texture.format);\n    const viewDescriptor = {};\n    const sampler = undefined;\n    const results = await doTextureCalls(t, texture, viewDescriptor, textureType, sampler, calls);\n    const res = await checkCallResults(\n      t,\n      { texels, descriptor, viewDescriptor },\n      textureType,\n      sampler,\n      calls,\n      results\n    );\n    t.expectOK(res);\n  });\n\ng.test('multisampled')\n  .specURL('https://www.w3.org/TR/WGSL/#textureload')\n  .desc(\n    `\nC is i32 or u32\n\nfn textureLoad(t: texture_multisampled_2d<T>, coords: vec2<C>, sample_index: C)-> vec4<T>\nfn textureLoad(t: texture_depth_multisampled_2d, coords: vec2<C>, sample_index: C)-> f32\n\nParameters:\n * t: The sampled texture to read from\n * coords: The 0-based texel coordinate\n * sample_index: The 0-based sample index of the multisampled texture\n`\n  )\n  .params(u =>\n    u\n      .combine('texture_type', [\n        'texture_multisampled_2d',\n        'texture_depth_multisampled_2d',\n      ] as const)\n      .beginSubcases()\n      .combine('C', ['i32', 'u32'] as const)\n      .combine('coords', generateCoordBoundaries(2))\n      .combine('sample_index', [-1, 0, `sampleCount-1`, `sampleCount`] as const)\n  )\n  .unimplemented();\n\ng.test('depth')\n  .specURL('https://www.w3.org/TR/WGSL/#textureload')\n  .desc(\n    `\nC is i32 or u32\n\nfn textureLoad(t: texture_depth_2d, coords: vec2<C>, level: C) -> f32\n\nParameters:\n * t: The sampled texture to read from\n * coords: The 0-based texel coordinate\n * level: The mip level, with level 0 containing a full size version of the texture\n`\n  )\n  .paramsSubcasesOnly(u =>\n    u\n      .combine('C', ['i32', 'u32'] as const)\n      .combine('coords', generateCoordBoundaries(2))\n      .combine('level', [-1, 0, `numLevels-1`, `numLevels`] as const)\n  )\n  .unimplemented();\n\ng.test('external')\n  .specURL('https://www.w3.org/TR/WGSL/#textureload')\n  .desc(\n    `\nC is i32 or u32\n\nfn textureLoad(t: texture_external, coords: vec2<C>) -> vec4<f32>\n\nParameters:\n * t: The sampled texture to read from\n * coords: The 0-based texel coordinate\n`\n  )\n  .paramsSubcasesOnly(u =>\n    u.combine('C', ['i32', 'u32'] as const).combine('coords', generateCoordBoundaries(2))\n  )\n  .unimplemented();\n\ng.test('arrayed')\n  .specURL('https://www.w3.org/TR/WGSL/#textureload')\n  .desc(\n    `\nC is i32 or u32\n\nfn textureLoad(t: texture_2d_array<T>, coords: vec2<C>, array_index: A, level: L) -> vec4<T>\nfn textureLoad(t: texture_depth_2d_array, coords: vec2<C>, array_index: A, level: L) -> f32\n\nParameters:\n * t: The sampled texture to read from\n * coords: The 0-based texel coordinate\n * array_index: The 0-based texture array index\n * level: The mip level, with level 0 containing a full size version of the texture\n`\n  )\n  .params(u =>\n    u\n      .combine('format', kTestableColorFormats)\n      // MAINTENANCE_TODO: Update createTextureFromTexelViews to support depth32float and remove this filter.\n      .filter(t => t.format !== 'depth32float' && !isCompressedFloatTextureFormat(t.format))\n      .combine('texture_type', ['texture_2d_array', 'texture_depth_2d_array'] as const)\n      .filter(\n        t => !(t.texture_type === 'texture_depth_2d_array' && !isDepthTextureFormat(t.format))\n      )\n      .beginSubcases()\n      .combine('C', ['i32', 'u32'] as const)\n      .combine('A', ['i32', 'u32'] as const)\n      .combine('L', ['i32', 'u32'] as const)\n      .combine('coordsBoundary', generateCoordBoundaries(3))\n      .combine('array_index', [-1, 0, `numLayers-1`, `numLayers`] as const)\n      // Only test array_index out of bounds if coordBoundary is in bounds\n      .filter(t => !(t.array_index !== 0 && t.coordsBoundary !== 'in-bounds'))\n      .combine('level', [-1, 0, `numLevels-1`, `numLevels`] as const)\n      // Only test level out of bounds if coordBoundary and array_index are in bounds\n      .filter(t => !(t.level !== 0 && (t.coordsBoundary !== 'in-bounds' || t.array_index !== 0)))\n      .filter(filterOutU32WithNegativeValues)\n  )\n  .beforeAllSubcases(t => {\n    const { format } = t.params;\n    t.skipIfTextureFormatNotSupported(format);\n    t.selectDeviceForTextureFormatOrSkipTestCase(t.params.format);\n  })\n  .fn(async t => {\n    const { texture_type, format, C, A, L, coordsBoundary, level, array_index } = t.params;\n\n    // We want at least 4 blocks or something wide enough for 3 mip levels.\n    const size = chooseTextureSize({ minSize: 8, minBlocks: 4, format, viewDimension: '3d' });\n\n    const descriptor: GPUTextureDescriptor = {\n      format,\n      size,\n      usage: GPUTextureUsage.COPY_DST | GPUTextureUsage.TEXTURE_BINDING,\n      mipLevelCount: maxMipLevelCount({ size }),\n    };\n    const { texels, texture } = await createTextureWithRandomDataAndGetTexels(t, descriptor);\n    const mipLevel = getMipLevelFromLevelSpec(texture.mipLevelCount, level);\n    const arrayIndex = getLayerFromLayerSpec(texture.depthOrArrayLayers, array_index);\n    const coords = getCoordinateForBoundaries<vec2>(texture, mipLevel, coordsBoundary);\n\n    const calls: TextureCall<vec2>[] = [\n      {\n        builtin: 'textureLoad',\n        coordType: C === 'i32' ? 'i' : 'u',\n        levelType: L === 'i32' ? 'i' : 'u',\n        arrayIndexType: A === 'i32' ? 'i' : 'u',\n        arrayIndex,\n        mipLevel,\n        coords,\n      },\n    ];\n    const textureType = appendComponentTypeForFormatToTextureType(texture_type, texture.format);\n    const viewDescriptor = {};\n    const sampler = undefined;\n    const results = await doTextureCalls(t, texture, viewDescriptor, textureType, sampler, calls);\n    const res = await checkCallResults(\n      t,\n      { texels, descriptor, viewDescriptor },\n      textureType,\n      sampler,\n      calls,\n      results\n    );\n    t.expectOK(res);\n  });\n\n// Returns texel values to use as inputs for textureLoad.\n// Values are kept simple to avoid rounding issues.\nfunction shaderValues(format: string, type: string) {\n  switch (type) {\n    case 'f32': {\n      switch (format) {\n        case 'rbga8snorm':\n          // prettier-ignore\n          return [\n            { r:  0.0, g:  0.0, b:  0.0, a:  0.0, },\n            { r:  0.2, g:  0.4, b:  0.6, a:  0.8, },\n            { r: -0.2, g: -0.4, b: -0.6, a: -0.8, },\n            { r:  0.2, g: -0.4, b:  0.6, a: -0.8, },\n            { r: -0.2, g:  0.4, b: -0.6, a:  0.8, },\n            { r:  0.2, g:  0.2, b:  0.2, a:  0.2, },\n            { r: -0.2, g: -0.2, b: -0.2, a: -0.2, },\n            { r:  0.4, g:  0.4, b:  0.4, a:  0.4, },\n            { r: -0.4, g: -0.4, b: -0.4, a: -0.4, },\n            { r:  0.6, g:  0.6, b:  0.6, a:  0.6, },\n            { r: -0.6, g: -0.6, b: -0.6, a: -0.6, },\n            { r:  0.8, g:  0.8, b:  0.8, a:  0.8, },\n            { r: -0.8, g: -0.8, b: -0.8, a: -0.8, },\n          ];\n        case 'rgba8unorm':\n        case 'bgra8unorm':\n          // prettier-ignore\n          return [\n            { r: 0.0, g: 0.0, b: 0.0, a: 0.0, },\n            { r: 0.2, g: 0.4, b: 0.6, a: 0.8, },\n            { r: 0.9, g: 0.4, b: 0.6, a: 0.8, },\n            { r: 0.2, g: 0.9, b: 0.6, a: 0.8, },\n            { r: 0.2, g: 0.4, b: 0.9, a: 0.8, },\n            { r: 0.2, g: 0.4, b: 0.6, a: 0.9, },\n            { r: 0.2, g: 0.2, b: 0.2, a: 0.2, },\n            { r: 0.4, g: 0.4, b: 0.4, a: 0.4, },\n            { r: 0.6, g: 0.6, b: 0.6, a: 0.6, },\n            { r: 0.8, g: 0.8, b: 0.8, a: 0.8, },\n          ];\n        default:\n          // Stick within 16-bit ranges.\n          // prettier-ignore\n          return [\n            { r:  100, g:  128, b:  100, a:  128, },\n            { r:   64, g:   32, b:   32, a:   64, },\n            { r:    8, g:    0, b:    8, a:    0, },\n            { r:    0, g:    0, b:    0, a:    0, },\n            { r: -100, g:  128, b:  100, a:  128, },\n            { r:  -64, g:   32, b:   32, a:   64, },\n            { r:   -8, g:    0, b:    8, a:    0, },\n            { r:  100, g: -128, b:  100, a:  128, },\n            { r:   64, g:  -32, b:   32, a:   64, },\n            { r:    8, g:    0, b:    8, a:    0, },\n            { r:  100, g:  128, b: -100, a:  128, },\n            { r:   64, g:   32, b:  -32, a:   64, },\n            { r:    8, g:    0, b:   -8, a:    0, },\n            { r:  100, g:  128, b:  100, a: -128, },\n            { r:   64, g:   32, b:   32, a:  -64, },\n            { r:    8, g:    0, b:    8, a:    0, },\n          ];\n      }\n      break;\n    }\n    case 'u32':\n      // Keep all ranges within u8.\n      // prettier-ignore\n      return [\n        { r:   0, g:   0, b:   0, a:   0, },\n        { r:   0, g:   8, b:  16, a: 128, },\n        { r:   8, g:  16, b:  32, a:  64, },\n        { r:  16, g:  32, b:  64, a: 128, },\n        { r: 255, g: 254, b: 253, a: 252, },\n        { r: 255, g: 255, b: 255, a: 255, },\n        { r: 128, g:  64, b:  32, a:  16, },\n        { r:  64, g:  32, b:  16, a:   8, },\n        { r:  32, g:  16, b:   8, a:   0, },\n      ];\n    case 'i32':\n      // Keep all ranges i8\n      // prettier-ignore\n      return [\n        { r:    0, g:    0, b:    0, a:    0, },\n        { r:    0, g:   -8, b:   16, a:  127, },\n        { r:    8, g:   16, b:  -32, a:   64, },\n        { r:  -16, g:   32, b:   64, a: -128, },\n        { r:  127, g:  126, b:  125, a:  124, },\n        { r: -128, g: -127, b: -126, a: -125, },\n        { r:  127, g:  127, b:  127, a:  127, },\n        { r: -128, g: -128, b: -128, a: -128, },\n      ];\n    default:\n      unreachable(`unhandled shader type ${type}`);\n      break;\n  }\n  return [];\n}\n\ng.test('storage_texel_formats')\n  .desc('Test loading of texel formats')\n  .params(u => u.combineWithParams([...TexelFormats, { format: 'bgra8unorm', _shaderType: 'f32' }]))\n  .beforeAllSubcases(t => {\n    t.skipIf(!t.hasLanguageFeature('readonly_and_readwrite_storage_textures'));\n    if (t.params.format === 'bgra8unorm') {\n      t.selectDeviceOrSkipTestCase('bgra8unorm-storage');\n    } else {\n      t.skipIfTextureFormatNotUsableAsStorageTexture(t.params.format as GPUTextureFormat);\n    }\n  })\n  .fn(t => {\n    const { format, _shaderType } = t.params;\n    const values = shaderValues(format, _shaderType);\n\n    // To avoid rounding issues, unorm and snorm values are repacked in the shader.\n    let useType = _shaderType;\n    let assignValue = `v`;\n    if (format === 'bgra8unorm' || format === 'rgba8unorm') {\n      useType = 'u32';\n      assignValue = `vec4u(pack4x8unorm(v),0,0,0)`;\n    } else if (format === 'rgba8snorm') {\n      useType = 'u32';\n      assignValue = `vec4u(pack4x8snorm(v),0,0,0)`;\n    }\n    const wgsl = `\nrequires readonly_and_readwrite_storage_textures;\n\n@group(0) @binding(0)\nvar tex : texture_storage_1d<${format}, read>;\n\n@group(0) @binding(1)\nvar<storage, read_write> out : array<vec4<${useType}>>;\n\n@compute @workgroup_size(${values.length})\nfn main(@builtin(global_invocation_id) gid : vec3u) {\n  let v = textureLoad(tex, gid.x);\n  out[gid.x] = ${assignValue};\n}`;\n\n    const bytesPerRow = 256;\n    let bytesPerTexel = 4;\n    switch (format) {\n      case 'rgba16uint':\n      case 'rgba16sint':\n      case 'rgba16float':\n      case 'rg32uint':\n      case 'rg32sint':\n      case 'rg32float':\n        bytesPerTexel = 8;\n        break;\n      case 'rgba32uint':\n      case 'rgba32sint':\n      case 'rgba32float':\n        bytesPerTexel = 16;\n        break;\n      default:\n        break;\n    }\n\n    const textureSize: GPUExtent3D = {\n      width: bytesPerRow / bytesPerTexel,\n      height: 1,\n      depthOrArrayLayers: 1,\n    };\n    const texture = t.createTextureTracked({\n      format: format as GPUTextureFormat,\n      dimension: '1d',\n      size: textureSize,\n      mipLevelCount: 1,\n      usage: GPUTextureUsage.STORAGE_BINDING | GPUTextureUsage.COPY_DST,\n    });\n    const outputBuffer = t.makeBufferWithContents(\n      new Uint32Array([...iterRange(values.length * 4, x => 0)]),\n      GPUBufferUsage.COPY_SRC | GPUBufferUsage.COPY_DST | GPUBufferUsage.STORAGE\n    );\n    t.trackForCleanup(outputBuffer);\n\n    const transformed = values.flatMap(x => {\n      switch (format) {\n        case 'rgba8unorm':\n          return pack4x8unorm(x.r, x.g, x.b, x.a);\n        case 'bgra8unorm':\n          return pack4x8unorm(x.b, x.g, x.r, x.a);\n        case 'rgba8snorm':\n          return pack4x8snorm(x.r, x.g, x.b, x.a);\n        case 'r32uint':\n        case 'r32sint':\n          return x.r;\n        case 'rg32uint':\n        case 'rg32sint':\n          return [x.r, x.g];\n        case 'rgba32uint':\n        case 'rgba32sint':\n          return [x.r, x.g, x.b, x.a];\n        case 'rgba8uint':\n        case 'rgba8sint':\n          return (x.r & 0xff) | ((x.g & 0xff) << 8) | ((x.b & 0xff) << 16) | ((x.a & 0xff) << 24);\n        case 'rgba16uint':\n        case 'rgba16sint':\n          return [(x.r & 0xffff) | ((x.g & 0xffff) << 16), (x.b & 0xffff) | ((x.a & 0xffff) << 16)];\n        case 'r32float':\n          return numberToFloatBits(x.r, kFloat32Format);\n        case 'rg32float':\n          return [numberToFloatBits(x.r, kFloat32Format), numberToFloatBits(x.g, kFloat32Format)];\n        case 'rgba32float':\n          return [\n            numberToFloatBits(x.r, kFloat32Format),\n            numberToFloatBits(x.g, kFloat32Format),\n            numberToFloatBits(x.b, kFloat32Format),\n            numberToFloatBits(x.a, kFloat32Format),\n          ];\n        case 'rgba16float':\n          return [\n            (numberToFloatBits(x.r, kFloat16Format) & 0xffff) |\n              ((numberToFloatBits(x.g, kFloat16Format) & 0xffff) << 16),\n            (numberToFloatBits(x.b, kFloat16Format) & 0xffff) |\n              ((numberToFloatBits(x.a, kFloat16Format) & 0xffff) << 16),\n          ];\n        default:\n          unreachable(`unhandled format ${format}`);\n          break;\n      }\n      return 0;\n    });\n\n    const texelBuffer = t.makeBufferWithContents(\n      new Uint32Array([\n        ...iterRange(bytesPerRow, x => {\n          if (x < transformed.length) {\n            return transformed[x];\n          } else {\n            return 0;\n          }\n        }),\n      ]),\n      GPUBufferUsage.COPY_SRC | GPUBufferUsage.COPY_DST | GPUBufferUsage.STORAGE\n    );\n    t.trackForCleanup(texelBuffer);\n\n    const pipeline = t.device.createComputePipeline({\n      layout: 'auto',\n      compute: {\n        module: t.device.createShaderModule({\n          code: wgsl,\n        }),\n        entryPoint: 'main',\n      },\n    });\n    const bg = t.device.createBindGroup({\n      layout: pipeline.getBindGroupLayout(0),\n      entries: [\n        {\n          binding: 0,\n          resource: texture.createView({\n            format: format as GPUTextureFormat,\n            dimension: '1d',\n          }),\n        },\n        {\n          binding: 1,\n          resource: {\n            buffer: outputBuffer,\n          },\n        },\n      ],\n    });\n\n    const encoder = t.device.createCommandEncoder();\n    encoder.copyBufferToTexture(\n      {\n        buffer: texelBuffer,\n        offset: 0,\n        bytesPerRow,\n        rowsPerImage: 1,\n      },\n      { texture },\n      textureSize\n    );\n\n    const pass = encoder.beginComputePass();\n    pass.setPipeline(pipeline);\n    pass.setBindGroup(0, bg);\n    pass.dispatchWorkgroups(1, 1, 1);\n    pass.end();\n    t.queue.submit([encoder.finish()]);\n\n    const expected = new Uint32Array(\n      values.flatMap(x => {\n        switch (format) {\n          case 'r32uint':\n          case 'r32sint':\n            return [x.r, 0, 0, 1];\n          case 'rg32uint':\n          case 'rg32sint':\n            return [x.r, x.g, 0, 1];\n          case 'r32float':\n            return [\n              numberToFloatBits(x.r, kFloat32Format),\n              0,\n              0,\n              numberToFloatBits(1, kFloat32Format),\n            ];\n          case 'rg32float':\n            return [\n              numberToFloatBits(x.r, kFloat32Format),\n              numberToFloatBits(x.g, kFloat32Format),\n              0,\n              numberToFloatBits(1, kFloat32Format),\n            ];\n          case 'rgba32float':\n          case 'rgba16float':\n            return [\n              numberToFloatBits(x.r, kFloat32Format),\n              numberToFloatBits(x.g, kFloat32Format),\n              numberToFloatBits(x.b, kFloat32Format),\n              numberToFloatBits(x.a, kFloat32Format),\n            ];\n          case 'rgba8unorm':\n          case 'bgra8unorm':\n            return [pack4x8unorm(x.r, x.g, x.b, x.a), 0, 0, 0];\n          case 'rgba8snorm':\n            return [pack4x8snorm(x.r, x.g, x.b, x.a), 0, 0, 0];\n          default:\n            break;\n        }\n        return [x.r, x.g, x.b, x.a];\n      })\n    );\n    t.expectGPUBufferValuesEqual(outputBuffer, expected);\n  });\n"],"mappings":"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"}