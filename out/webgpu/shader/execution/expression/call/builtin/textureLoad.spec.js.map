{"version":3,"file":"textureLoad.spec.js","names":["description","makeTestGroup","unreachable","iterRange","isCompressedFloatTextureFormat","isDepthTextureFormat","kCompressedTextureFormats","kEncodableTextureFormats","GPUTest","kFloat32Format","kFloat16Format","numberToFloatBits","pack4x8unorm","pack4x8snorm","TexelFormats","checkCallResults","chooseTextureSize","createTextureWithRandomDataAndGetTexels","doTextureCalls","appendComponentTypeForFormatToTextureType","generateCoordBoundaries","getCoordinateForBoundaries","getMipLevelFromLevelSpec","isBoundaryNegative","isLevelSpecNegative","kTestableColorFormats","filterOutDepthAndCompressedFloatTextureFormats","format","filterOutU32WithNegativeValues","t","C","level","coordsBoundary","g","test","specURL","desc","params","u","combine","unimplemented","filter","beginSubcases","beforeAllSubcases","skipIfTextureFormatNotSupported","selectDeviceForTextureFormatOrSkipTestCase","fn","L","width","height","minSize","minBlocks","descriptor","size","usage","GPUTextureUsage","COPY_DST","TEXTURE_BINDING","texels","texture","mipLevel","mipLevelCount","coords","calls","builtin","coordType","levelType","textureType","viewDescriptor","sampler","undefined","results","res","expectOK","paramsSubcasesOnly","shaderValues","type","r","b","a","combineWithParams","_shaderType","skipIf","hasLanguageFeature","selectDeviceOrSkipTestCase","skipIfTextureFormatNotUsableAsStorageTexture","values","useType","assignValue","wgsl","length","bytesPerRow","bytesPerTexel","textureSize","depthOrArrayLayers","createTextureTracked","dimension","STORAGE_BINDING","outputBuffer","makeBufferWithContents","Uint32Array","x","GPUBufferUsage","COPY_SRC","STORAGE","trackForCleanup","transformed","flatMap","texelBuffer","pipeline","device","createComputePipeline","layout","compute","module","createShaderModule","code","entryPoint","bg","createBindGroup","getBindGroupLayout","entries","binding","resource","createView","buffer","encoder","createCommandEncoder","copyBufferToTexture","offset","rowsPerImage","pass","beginComputePass","setPipeline","setBindGroup","dispatchWorkgroups","end","queue","submit","finish","expected","expectGPUBufferValuesEqual"],"sources":["../../../../../../../src/webgpu/shader/execution/expression/call/builtin/textureLoad.spec.ts"],"sourcesContent":["export const description = `\nExecution tests for the 'textureLoad' builtin function\n\nReads a single texel from a texture without sampling or filtering.\n\nReturns the unfiltered texel data.\n\nAn out of bounds access occurs if:\n * any element of coords is outside the range [0, textureDimensions(t, level)) for the corresponding element, or\n * array_index is outside the range [0, textureNumLayers(t)), or\n * level is outside the range [0, textureNumLevels(t))\n\nIf an out of bounds access occurs, the built-in function returns one of:\n * The data for some texel within bounds of the texture\n * A vector (0,0,0,0) or (0,0,0,1) of the appropriate type for non-depth textures\n * 0.0 for depth textures\n\nTODO: Test textureLoad with depth textures as texture_2d, etc...\n`;\n\nimport { makeTestGroup } from '../../../../../../common/framework/test_group.js';\nimport { unreachable, iterRange } from '../../../../../../common/util/util.js';\nimport {\n  isCompressedFloatTextureFormat,\n  isDepthTextureFormat,\n  kCompressedTextureFormats,\n  kEncodableTextureFormats,\n} from '../../../../../format_info.js';\nimport { GPUTest } from '../../../../../gpu_test.js';\nimport {\n  kFloat32Format,\n  kFloat16Format,\n  numberToFloatBits,\n  pack4x8unorm,\n  pack4x8snorm,\n} from '../../../../../util/conversion.js';\nimport { TexelFormats } from '../../../../types.js';\n\nimport {\n  TextureCall,\n  checkCallResults,\n  chooseTextureSize,\n  createTextureWithRandomDataAndGetTexels,\n  doTextureCalls,\n  appendComponentTypeForFormatToTextureType,\n  vec2,\n} from './texture_utils.js';\nimport {\n  Boundary,\n  LevelSpec,\n  generateCoordBoundaries,\n  getCoordinateForBoundaries,\n  getMipLevelFromLevelSpec,\n  isBoundaryNegative,\n  isLevelSpecNegative,\n} from './utils.js';\n\nconst kTestableColorFormats = [...kEncodableTextureFormats, ...kCompressedTextureFormats] as const;\n\nfunction filterOutDepthAndCompressedFloatTextureFormats({ format }: { format: GPUTextureFormat }) {\n  return !isDepthTextureFormat(format) && !isCompressedFloatTextureFormat(format);\n}\n\nfunction filterOutU32WithNegativeValues(t: {\n  C: 'i32' | 'u32';\n  level: LevelSpec;\n  coordsBoundary: Boundary;\n}) {\n  return t.C === 'i32' || (!isLevelSpecNegative(t.level) && !isBoundaryNegative(t.coordsBoundary));\n}\n\nexport const g = makeTestGroup(GPUTest);\n\ng.test('sampled_1d')\n  .specURL('https://www.w3.org/TR/WGSL/#textureload')\n  .desc(\n    `\nC is i32 or u32\n\nfn textureLoad(t: texture_1d<T>, coords: C, level: C) -> vec4<T>\n\nParameters:\n * t: The sampled texture to read from\n * coords: The 0-based texel coordinate\n * level: The mip level, with level 0 containing a full size version of the texture\n`\n  )\n  .params(u =>\n    u\n      .combine('C', ['i32', 'u32'] as const)\n      .combine('coords', generateCoordBoundaries(1))\n      .combine('level', [-1, 0, `numlevels-1`, `numlevels`] as const)\n  )\n  .unimplemented();\n\ng.test('sampled_2d')\n  .specURL('https://www.w3.org/TR/WGSL/#textureload')\n  .desc(\n    `\nC is i32 or u32\nL is i32 or u32\n\nfn textureLoad(t: texture_2d<T>, coords: vec2<C>, level: L) -> vec4<T>\n\nParameters:\n * t: The sampled texture to read from\n * coords: The 0-based texel coordinate\n * level: The mip level, with level 0 containing a full size version of the texture\n`\n  )\n  .params(u =>\n    u\n      .combine('format', kTestableColorFormats)\n      .filter(filterOutDepthAndCompressedFloatTextureFormats)\n      .beginSubcases()\n      .combine('C', ['i32', 'u32'] as const)\n      .combine('L', ['i32', 'u32'] as const)\n      .combine('coordsBoundary', generateCoordBoundaries(2))\n      .combine('level', [-1, 0, `numLevels-1`, `numLevels`] as const)\n      .filter(filterOutU32WithNegativeValues)\n  )\n  .beforeAllSubcases(t => {\n    const { format } = t.params;\n    t.skipIfTextureFormatNotSupported(format);\n    t.selectDeviceForTextureFormatOrSkipTestCase(t.params.format);\n  })\n  .fn(async t => {\n    const { format, C, L, coordsBoundary, level } = t.params;\n\n    // We want at least 4 blocks or something wide enough for 3 mip levels.\n    const [width, height] = chooseTextureSize({ minSize: 8, minBlocks: 4, format });\n\n    const descriptor: GPUTextureDescriptor = {\n      format,\n      size: { width, height },\n      usage: GPUTextureUsage.COPY_DST | GPUTextureUsage.TEXTURE_BINDING,\n    };\n    const { texels, texture } = await createTextureWithRandomDataAndGetTexels(t, descriptor);\n    const mipLevel = getMipLevelFromLevelSpec(texture.mipLevelCount, level);\n    const coords = getCoordinateForBoundaries<vec2>(texture, mipLevel, coordsBoundary);\n\n    const calls: TextureCall<vec2>[] = [\n      {\n        builtin: 'textureLoad',\n        coordType: C === 'i32' ? 'i' : 'u',\n        levelType: L === 'i32' ? 'i' : 'u',\n        mipLevel,\n        coords,\n      },\n    ];\n    const textureType = appendComponentTypeForFormatToTextureType('texture_2d', texture.format);\n    const viewDescriptor = {};\n    const sampler = undefined;\n    const results = await doTextureCalls(t, texture, viewDescriptor, textureType, sampler, calls);\n    const res = await checkCallResults(\n      t,\n      { texels, descriptor, viewDescriptor },\n      textureType,\n      sampler,\n      calls,\n      results\n    );\n    t.expectOK(res);\n  });\n\ng.test('sampled_3d')\n  .specURL('https://www.w3.org/TR/WGSL/#textureload')\n  .desc(\n    `\nC is i32 or u32\n\nfn textureLoad(t: texture_3d<T>, coords: vec3<C>, level: C) -> vec4<T>\n\nParameters:\n * t: The sampled texture to read from\n * coords: The 0-based texel coordinate\n * level: The mip level, with level 0 containing a full size version of the texture\n`\n  )\n  .params(u =>\n    u\n      .combine('C', ['i32', 'u32'] as const)\n      .combine('coords', generateCoordBoundaries(3))\n      .combine('level', [-1, 0, `numLevels-1`, `numLevels`] as const)\n  )\n  .unimplemented();\n\ng.test('multisampled')\n  .specURL('https://www.w3.org/TR/WGSL/#textureload')\n  .desc(\n    `\nC is i32 or u32\n\nfn textureLoad(t: texture_multisampled_2d<T>, coords: vec2<C>, sample_index: C)-> vec4<T>\nfn textureLoad(t: texture_depth_multisampled_2d, coords: vec2<C>, sample_index: C)-> f32\n\nParameters:\n * t: The sampled texture to read from\n * coords: The 0-based texel coordinate\n * sample_index: The 0-based sample index of the multisampled texture\n`\n  )\n  .params(u =>\n    u\n      .combine('texture_type', [\n        'texture_multisampled_2d',\n        'texture_depth_multisampled_2d',\n      ] as const)\n      .beginSubcases()\n      .combine('C', ['i32', 'u32'] as const)\n      .combine('coords', generateCoordBoundaries(2))\n      .combine('sample_index', [-1, 0, `sampleCount-1`, `sampleCount`] as const)\n  )\n  .unimplemented();\n\ng.test('depth')\n  .specURL('https://www.w3.org/TR/WGSL/#textureload')\n  .desc(\n    `\nC is i32 or u32\n\nfn textureLoad(t: texture_depth_2d, coords: vec2<C>, level: C) -> f32\n\nParameters:\n * t: The sampled texture to read from\n * coords: The 0-based texel coordinate\n * level: The mip level, with level 0 containing a full size version of the texture\n`\n  )\n  .paramsSubcasesOnly(u =>\n    u\n      .combine('C', ['i32', 'u32'] as const)\n      .combine('coords', generateCoordBoundaries(2))\n      .combine('level', [-1, 0, `numLevels-1`, `numLevels`] as const)\n  )\n  .unimplemented();\n\ng.test('external')\n  .specURL('https://www.w3.org/TR/WGSL/#textureload')\n  .desc(\n    `\nC is i32 or u32\n\nfn textureLoad(t: texture_external, coords: vec2<C>) -> vec4<f32>\n\nParameters:\n * t: The sampled texture to read from\n * coords: The 0-based texel coordinate\n`\n  )\n  .paramsSubcasesOnly(u =>\n    u.combine('C', ['i32', 'u32'] as const).combine('coords', generateCoordBoundaries(2))\n  )\n  .unimplemented();\n\ng.test('arrayed')\n  .specURL('https://www.w3.org/TR/WGSL/#textureload')\n  .desc(\n    `\nC is i32 or u32\n\nfn textureLoad(t: texture_2d_array<T>, coords: vec2<C>, array_index: C, level: C) -> vec4<T>\nfn textureLoad(t: texture_depth_2d_array, coords: vec2<C>, array_index: C, level: C) -> f32\n\nParameters:\n * t: The sampled texture to read from\n * coords: The 0-based texel coordinate\n * array_index: The 0-based texture array index\n * level: The mip level, with level 0 containing a full size version of the texture\n`\n  )\n  .params(u =>\n    u\n      .combine('texture_type', ['texture_2d_array', 'texture_depth_2d_array'] as const)\n      .beginSubcases()\n      .combine('C', ['i32', 'u32'] as const)\n      .combine('coords', generateCoordBoundaries(2))\n      .combine('array_index', [-1, 0, `numlayers-1`, `numlayers`] as const)\n      .combine('level', [-1, 0, `numLevels-1`, `numLevels`] as const)\n  )\n  .unimplemented();\n\n// Returns texel values to use as inputs for textureLoad.\n// Values are kept simple to avoid rounding issues.\nfunction shaderValues(format: string, type: string) {\n  switch (type) {\n    case 'f32': {\n      switch (format) {\n        case 'rbga8snorm':\n          // prettier-ignore\n          return [\n            { r:  0.0, g:  0.0, b:  0.0, a:  0.0, },\n            { r:  0.2, g:  0.4, b:  0.6, a:  0.8, },\n            { r: -0.2, g: -0.4, b: -0.6, a: -0.8, },\n            { r:  0.2, g: -0.4, b:  0.6, a: -0.8, },\n            { r: -0.2, g:  0.4, b: -0.6, a:  0.8, },\n            { r:  0.2, g:  0.2, b:  0.2, a:  0.2, },\n            { r: -0.2, g: -0.2, b: -0.2, a: -0.2, },\n            { r:  0.4, g:  0.4, b:  0.4, a:  0.4, },\n            { r: -0.4, g: -0.4, b: -0.4, a: -0.4, },\n            { r:  0.6, g:  0.6, b:  0.6, a:  0.6, },\n            { r: -0.6, g: -0.6, b: -0.6, a: -0.6, },\n            { r:  0.8, g:  0.8, b:  0.8, a:  0.8, },\n            { r: -0.8, g: -0.8, b: -0.8, a: -0.8, },\n          ];\n        case 'rgba8unorm':\n        case 'bgra8unorm':\n          // prettier-ignore\n          return [\n            { r: 0.0, g: 0.0, b: 0.0, a: 0.0, },\n            { r: 0.2, g: 0.4, b: 0.6, a: 0.8, },\n            { r: 0.9, g: 0.4, b: 0.6, a: 0.8, },\n            { r: 0.2, g: 0.9, b: 0.6, a: 0.8, },\n            { r: 0.2, g: 0.4, b: 0.9, a: 0.8, },\n            { r: 0.2, g: 0.4, b: 0.6, a: 0.9, },\n            { r: 0.2, g: 0.2, b: 0.2, a: 0.2, },\n            { r: 0.4, g: 0.4, b: 0.4, a: 0.4, },\n            { r: 0.6, g: 0.6, b: 0.6, a: 0.6, },\n            { r: 0.8, g: 0.8, b: 0.8, a: 0.8, },\n          ];\n        default:\n          // Stick within 16-bit ranges.\n          // prettier-ignore\n          return [\n            { r:  100, g:  128, b:  100, a:  128, },\n            { r:   64, g:   32, b:   32, a:   64, },\n            { r:    8, g:    0, b:    8, a:    0, },\n            { r:    0, g:    0, b:    0, a:    0, },\n            { r: -100, g:  128, b:  100, a:  128, },\n            { r:  -64, g:   32, b:   32, a:   64, },\n            { r:   -8, g:    0, b:    8, a:    0, },\n            { r:  100, g: -128, b:  100, a:  128, },\n            { r:   64, g:  -32, b:   32, a:   64, },\n            { r:    8, g:    0, b:    8, a:    0, },\n            { r:  100, g:  128, b: -100, a:  128, },\n            { r:   64, g:   32, b:  -32, a:   64, },\n            { r:    8, g:    0, b:   -8, a:    0, },\n            { r:  100, g:  128, b:  100, a: -128, },\n            { r:   64, g:   32, b:   32, a:  -64, },\n            { r:    8, g:    0, b:    8, a:    0, },\n          ];\n      }\n      break;\n    }\n    case 'u32':\n      // Keep all ranges within u8.\n      // prettier-ignore\n      return [\n        { r:   0, g:   0, b:   0, a:   0, },\n        { r:   0, g:   8, b:  16, a: 128, },\n        { r:   8, g:  16, b:  32, a:  64, },\n        { r:  16, g:  32, b:  64, a: 128, },\n        { r: 255, g: 254, b: 253, a: 252, },\n        { r: 255, g: 255, b: 255, a: 255, },\n        { r: 128, g:  64, b:  32, a:  16, },\n        { r:  64, g:  32, b:  16, a:   8, },\n        { r:  32, g:  16, b:   8, a:   0, },\n      ];\n    case 'i32':\n      // Keep all ranges i8\n      // prettier-ignore\n      return [\n        { r:    0, g:    0, b:    0, a:    0, },\n        { r:    0, g:   -8, b:   16, a:  127, },\n        { r:    8, g:   16, b:  -32, a:   64, },\n        { r:  -16, g:   32, b:   64, a: -128, },\n        { r:  127, g:  126, b:  125, a:  124, },\n        { r: -128, g: -127, b: -126, a: -125, },\n        { r:  127, g:  127, b:  127, a:  127, },\n        { r: -128, g: -128, b: -128, a: -128, },\n      ];\n    default:\n      unreachable(`unhandled shader type ${type}`);\n      break;\n  }\n  return [];\n}\n\ng.test('storage_texel_formats')\n  .desc('Test loading of texel formats')\n  .params(u => u.combineWithParams([...TexelFormats, { format: 'bgra8unorm', _shaderType: 'f32' }]))\n  .beforeAllSubcases(t => {\n    t.skipIf(!t.hasLanguageFeature('readonly_and_readwrite_storage_textures'));\n    if (t.params.format === 'bgra8unorm') {\n      t.selectDeviceOrSkipTestCase('bgra8unorm-storage');\n    } else {\n      t.skipIfTextureFormatNotUsableAsStorageTexture(t.params.format as GPUTextureFormat);\n    }\n  })\n  .fn(t => {\n    const { format, _shaderType } = t.params;\n    const values = shaderValues(format, _shaderType);\n\n    // To avoid rounding issues, unorm and snorm values are repacked in the shader.\n    let useType = _shaderType;\n    let assignValue = `v`;\n    if (format === 'bgra8unorm' || format === 'rgba8unorm') {\n      useType = 'u32';\n      assignValue = `vec4u(pack4x8unorm(v),0,0,0)`;\n    } else if (format === 'rgba8snorm') {\n      useType = 'u32';\n      assignValue = `vec4u(pack4x8snorm(v),0,0,0)`;\n    }\n    const wgsl = `\nrequires readonly_and_readwrite_storage_textures;\n\n@group(0) @binding(0)\nvar tex : texture_storage_1d<${format}, read>;\n\n@group(0) @binding(1)\nvar<storage, read_write> out : array<vec4<${useType}>>;\n\n@compute @workgroup_size(${values.length})\nfn main(@builtin(global_invocation_id) gid : vec3u) {\n  let v = textureLoad(tex, gid.x);\n  out[gid.x] = ${assignValue};\n}`;\n\n    const bytesPerRow = 256;\n    let bytesPerTexel = 4;\n    switch (format) {\n      case 'rgba16uint':\n      case 'rgba16sint':\n      case 'rgba16float':\n      case 'rg32uint':\n      case 'rg32sint':\n      case 'rg32float':\n        bytesPerTexel = 8;\n        break;\n      case 'rgba32uint':\n      case 'rgba32sint':\n      case 'rgba32float':\n        bytesPerTexel = 16;\n        break;\n      default:\n        break;\n    }\n\n    const textureSize: GPUExtent3D = {\n      width: bytesPerRow / bytesPerTexel,\n      height: 1,\n      depthOrArrayLayers: 1,\n    };\n    const texture = t.createTextureTracked({\n      format: format as GPUTextureFormat,\n      dimension: '1d',\n      size: textureSize,\n      mipLevelCount: 1,\n      usage: GPUTextureUsage.STORAGE_BINDING | GPUTextureUsage.COPY_DST,\n    });\n    const outputBuffer = t.makeBufferWithContents(\n      new Uint32Array([...iterRange(values.length * 4, x => 0)]),\n      GPUBufferUsage.COPY_SRC | GPUBufferUsage.COPY_DST | GPUBufferUsage.STORAGE\n    );\n    t.trackForCleanup(outputBuffer);\n\n    const transformed = values.flatMap(x => {\n      switch (format) {\n        case 'rgba8unorm':\n          return pack4x8unorm(x.r, x.g, x.b, x.a);\n        case 'bgra8unorm':\n          return pack4x8unorm(x.b, x.g, x.r, x.a);\n        case 'rgba8snorm':\n          return pack4x8snorm(x.r, x.g, x.b, x.a);\n        case 'r32uint':\n        case 'r32sint':\n          return x.r;\n        case 'rg32uint':\n        case 'rg32sint':\n          return [x.r, x.g];\n        case 'rgba32uint':\n        case 'rgba32sint':\n          return [x.r, x.g, x.b, x.a];\n        case 'rgba8uint':\n        case 'rgba8sint':\n          return (x.r & 0xff) | ((x.g & 0xff) << 8) | ((x.b & 0xff) << 16) | ((x.a & 0xff) << 24);\n        case 'rgba16uint':\n        case 'rgba16sint':\n          return [(x.r & 0xffff) | ((x.g & 0xffff) << 16), (x.b & 0xffff) | ((x.a & 0xffff) << 16)];\n        case 'r32float':\n          return numberToFloatBits(x.r, kFloat32Format);\n        case 'rg32float':\n          return [numberToFloatBits(x.r, kFloat32Format), numberToFloatBits(x.g, kFloat32Format)];\n        case 'rgba32float':\n          return [\n            numberToFloatBits(x.r, kFloat32Format),\n            numberToFloatBits(x.g, kFloat32Format),\n            numberToFloatBits(x.b, kFloat32Format),\n            numberToFloatBits(x.a, kFloat32Format),\n          ];\n        case 'rgba16float':\n          return [\n            (numberToFloatBits(x.r, kFloat16Format) & 0xffff) |\n              ((numberToFloatBits(x.g, kFloat16Format) & 0xffff) << 16),\n            (numberToFloatBits(x.b, kFloat16Format) & 0xffff) |\n              ((numberToFloatBits(x.a, kFloat16Format) & 0xffff) << 16),\n          ];\n        default:\n          unreachable(`unhandled format ${format}`);\n          break;\n      }\n      return 0;\n    });\n\n    const texelBuffer = t.makeBufferWithContents(\n      new Uint32Array([\n        ...iterRange(bytesPerRow, x => {\n          if (x < transformed.length) {\n            return transformed[x];\n          } else {\n            return 0;\n          }\n        }),\n      ]),\n      GPUBufferUsage.COPY_SRC | GPUBufferUsage.COPY_DST | GPUBufferUsage.STORAGE\n    );\n    t.trackForCleanup(texelBuffer);\n\n    const pipeline = t.device.createComputePipeline({\n      layout: 'auto',\n      compute: {\n        module: t.device.createShaderModule({\n          code: wgsl,\n        }),\n        entryPoint: 'main',\n      },\n    });\n    const bg = t.device.createBindGroup({\n      layout: pipeline.getBindGroupLayout(0),\n      entries: [\n        {\n          binding: 0,\n          resource: texture.createView({\n            format: format as GPUTextureFormat,\n            dimension: '1d',\n          }),\n        },\n        {\n          binding: 1,\n          resource: {\n            buffer: outputBuffer,\n          },\n        },\n      ],\n    });\n\n    const encoder = t.device.createCommandEncoder();\n    encoder.copyBufferToTexture(\n      {\n        buffer: texelBuffer,\n        offset: 0,\n        bytesPerRow,\n        rowsPerImage: 1,\n      },\n      { texture },\n      textureSize\n    );\n\n    const pass = encoder.beginComputePass();\n    pass.setPipeline(pipeline);\n    pass.setBindGroup(0, bg);\n    pass.dispatchWorkgroups(1, 1, 1);\n    pass.end();\n    t.queue.submit([encoder.finish()]);\n\n    const expected = new Uint32Array(\n      values.flatMap(x => {\n        switch (format) {\n          case 'r32uint':\n          case 'r32sint':\n            return [x.r, 0, 0, 1];\n          case 'rg32uint':\n          case 'rg32sint':\n            return [x.r, x.g, 0, 1];\n          case 'r32float':\n            return [\n              numberToFloatBits(x.r, kFloat32Format),\n              0,\n              0,\n              numberToFloatBits(1, kFloat32Format),\n            ];\n          case 'rg32float':\n            return [\n              numberToFloatBits(x.r, kFloat32Format),\n              numberToFloatBits(x.g, kFloat32Format),\n              0,\n              numberToFloatBits(1, kFloat32Format),\n            ];\n          case 'rgba32float':\n          case 'rgba16float':\n            return [\n              numberToFloatBits(x.r, kFloat32Format),\n              numberToFloatBits(x.g, kFloat32Format),\n              numberToFloatBits(x.b, kFloat32Format),\n              numberToFloatBits(x.a, kFloat32Format),\n            ];\n          case 'rgba8unorm':\n          case 'bgra8unorm':\n            return [pack4x8unorm(x.r, x.g, x.b, x.a), 0, 0, 0];\n          case 'rgba8snorm':\n            return [pack4x8snorm(x.r, x.g, x.b, x.a), 0, 0, 0];\n          default:\n            break;\n        }\n        return [x.r, x.g, x.b, x.a];\n      })\n    );\n    t.expectGPUBufferValuesEqual(outputBuffer, expected);\n  });\n"],"mappings":"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"}