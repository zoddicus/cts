{"version":3,"file":"value_init.spec.js","names":["description","makeTestGroup","GPUTest","Type","g","generateShader","isF16","addressSpace","typeDecl","testValue","comparison","moduleScope","functionScope","run","t","wgsl","pipeline","device","createComputePipelineAsync","layout","compute","module","createShaderModule","code","entryPoint","resultBuffer","createBuffer","size","usage","GPUBufferUsage","STORAGE","COPY_SRC","trackForCleanup","zeroBuffer","UNIFORM","bindGroup","createBindGroup","getBindGroupLayout","entries","binding","resource","buffer","encoder","createCommandEncoder","pass","beginComputePass","setPipeline","setBindGroup","dispatchWorkgroups","end","queue","submit","finish","expectGPUBufferValuesEqual","Uint32Array","test","desc","params","u","combine","beforeAllSubcases","type","selectDeviceOrSkipTestCase","fn","create","count","beginSubcases","c","r","testScalarValue","arraySize","i","innerDecl","j"],"sources":["../../../../src/webgpu/shader/execution/value_init.spec.ts"],"sourcesContent":["export const description = `Test that variables in the shader are value initialized`;\n\nimport { makeTestGroup } from '../../../common/framework/test_group.js';\nimport { GPUTest } from '../../gpu_test.js';\nimport { Type } from '../../util/conversion.js';\n\nexport const g = makeTestGroup(GPUTest);\n\nfunction generateShader(\n  isF16: boolean,\n  addressSpace: string,\n  typeDecl: string,\n  testValue: string,\n  comparison: string\n): string {\n  let moduleScope = `\n    ${isF16 ? 'enable f16;' : ''}\n    struct Output {\n      failed : atomic<u32>\n    }\n    @group(0) @binding(0) var<storage, read_write> output : Output;\n  `;\n\n  let functionScope = '';\n  switch (addressSpace) {\n    case 'private':\n      moduleScope += `\\nvar<private> testVar: ${typeDecl} = ${testValue};`;\n      break;\n    case 'function':\n      functionScope += `\\nvar testVar: ${typeDecl} = ${testValue};`;\n      break;\n  }\n\n  return `\n    ${moduleScope}\n    @compute @workgroup_size(1, 1, 1)\n    fn main() {\n      ${functionScope}\n      ${comparison}\n    }\n  `;\n}\n\nasync function run(t: GPUTest, wgsl: string) {\n  const pipeline = await t.device.createComputePipelineAsync({\n    layout: 'auto',\n    compute: {\n      module: t.device.createShaderModule({\n        code: wgsl,\n      }),\n      entryPoint: 'main',\n    },\n  });\n\n  const resultBuffer = t.device.createBuffer({\n    size: 4,\n    usage: GPUBufferUsage.STORAGE | GPUBufferUsage.COPY_SRC,\n  });\n  t.trackForCleanup(resultBuffer);\n\n  const zeroBuffer = t.device.createBuffer({\n    size: 4,\n    usage: GPUBufferUsage.UNIFORM,\n  });\n  t.trackForCleanup(zeroBuffer);\n\n  const bindGroup = t.device.createBindGroup({\n    layout: pipeline.getBindGroupLayout(0),\n    entries: [\n      {\n        binding: 0,\n        resource: {\n          buffer: resultBuffer,\n        },\n      },\n    ],\n  });\n\n  const encoder = t.device.createCommandEncoder();\n  const pass = encoder.beginComputePass();\n  pass.setPipeline(pipeline);\n  pass.setBindGroup(0, bindGroup);\n  pass.dispatchWorkgroups(1);\n  pass.end();\n  t.queue.submit([encoder.finish()]);\n  t.expectGPUBufferValuesEqual(resultBuffer, new Uint32Array([0]));\n}\n\ng.test('scalars')\n  .desc(`Test that scalars in private, and function storage classes can be initialized to a value.`)\n  .params(u =>\n    u\n      .combine('addressSpace', ['private', 'function'] as const)\n      .combine('type', ['bool', 'f32', 'f16', 'i32', 'u32'] as const)\n  )\n  .beforeAllSubcases(t => {\n    if (t.params.type === 'f16') {\n      t.selectDeviceOrSkipTestCase('shader-f16');\n    }\n  })\n  .fn(async t => {\n    const typeDecl = t.params.type;\n    const testValue = Type[typeDecl].create(5).wgsl();\n\n    const comparison = `if (testVar != ${testValue}) {\n      atomicStore(&output.failed, 1u);\n    }`;\n    const wgsl = generateShader(\n      t.params.type === 'f16',\n      t.params.addressSpace,\n      typeDecl,\n      testValue,\n      comparison\n    );\n\n    await run(t, wgsl);\n  });\n\ng.test('vec')\n  .desc(`Test that vectors in private, and function storage classes can be initialized to a value.`)\n  .params(u =>\n    u\n      .combine('addressSpace', ['private', 'function'] as const)\n      .combine('type', ['bool', 'f32', 'f16', 'i32', 'u32'] as const)\n      .combine('count', [2, 3, 4] as const)\n  )\n  .beforeAllSubcases(t => {\n    if (t.params.type === 'f16') {\n      t.selectDeviceOrSkipTestCase('shader-f16');\n    }\n  })\n  .fn(async t => {\n    const typeDecl = `vec${t.params.count}<${t.params.type}>`;\n    const testValue = `${typeDecl}(${Type[t.params.type].create(5).wgsl()})`;\n\n    const comparison = `if (!all(testVar == ${testValue})) {\n      atomicStore(&output.failed, 1u);\n    }`;\n    const wgsl = generateShader(\n      t.params.type === 'f16',\n      t.params.addressSpace,\n      typeDecl,\n      testValue,\n      comparison\n    );\n\n    await run(t, wgsl);\n  });\n\ng.test('mat')\n  .desc(\n    `Test that matrices in private, and function storage classes can be initialized to a value.`\n  )\n  .params(u =>\n    u\n      .combine('addressSpace', ['private', 'function'] as const)\n      .combine('type', ['f32', 'f16'] as const)\n      .beginSubcases()\n      .combine('c', [2, 3, 4] as const)\n      .combine('r', [2, 3, 4] as const)\n  )\n  .beforeAllSubcases(t => {\n    if (t.params.type === 'f16') {\n      t.selectDeviceOrSkipTestCase('shader-f16');\n    }\n  })\n  .fn(async t => {\n    const typeDecl = `mat${t.params.c}x${t.params.r}<${t.params.type}>`;\n    const testScalarValue = Type[t.params.type].create(5).wgsl();\n\n    let testValue = `${typeDecl}(`;\n    for (let c = 0; c < t.params.c; c++) {\n      for (let r = 0; r < t.params.r; r++) {\n        testValue += `${testScalarValue},`;\n      }\n    }\n    testValue += ')';\n\n    const comparison = `for ( var i = 0; i < ${t.params.c}; i++) {\n      for (var k = 0; k < ${t.params.r}; k++) {\n        if (testVar[i][k] != ${testScalarValue}) {\n          atomicStore(&output.failed, 1u);\n        }\n      }\n    }`;\n    const wgsl = generateShader(\n      t.params.type === 'f16',\n      t.params.addressSpace,\n      typeDecl,\n      testValue,\n      comparison\n    );\n\n    await run(t, wgsl);\n  });\n\ng.test('array')\n  .desc(`Test that arrays in private, and function storage classes can be initialized to a value.`)\n  .params(u =>\n    u\n      .combine('addressSpace', ['private', 'function'] as const)\n      .combine('type', ['bool', 'i32', 'u32', 'f32', 'f16'] as const)\n  )\n  .beforeAllSubcases(t => {\n    if (t.params.type === 'f16') {\n      t.selectDeviceOrSkipTestCase('shader-f16');\n    }\n  })\n  .fn(async t => {\n    const arraySize = 4;\n    const typeDecl = `array<${t.params.type}, ${arraySize}>`;\n    const testScalarValue = Type[t.params.type].create(5).wgsl();\n\n    let testValue = `${typeDecl}(`;\n    for (let i = 0; i < arraySize; i++) {\n      testValue += `${testScalarValue},`;\n    }\n    testValue += ')';\n\n    const comparison = `for ( var i = 0; i < ${arraySize}; i++) {\n      if (testVar[i] != ${testScalarValue}) {\n        atomicStore(&output.failed, 1u);\n      }\n    }`;\n    const wgsl = generateShader(\n      t.params.type === 'f16',\n      t.params.addressSpace,\n      typeDecl,\n      testValue,\n      comparison\n    );\n\n    await run(t, wgsl);\n  });\n\ng.test('array,nested')\n  .desc(`Test that arrays in private, and function storage classes can be initialized to a value.`)\n  .params(u =>\n    u\n      .combine('addressSpace', ['private', 'function'] as const)\n      .combine('type', ['bool', 'i32', 'u32', 'f32', 'f16'] as const)\n  )\n  .beforeAllSubcases(t => {\n    if (t.params.type === 'f16') {\n      t.selectDeviceOrSkipTestCase('shader-f16');\n    }\n  })\n  .fn(async t => {\n    const arraySize = 4;\n\n    const innerDecl = `array<${t.params.type}, ${arraySize}>`;\n    const typeDecl = `array<${innerDecl}, ${arraySize}>`;\n    const testScalarValue = Type[t.params.type].create(5).wgsl();\n\n    let testValue = `${typeDecl}(`;\n    for (let i = 0; i < arraySize; i++) {\n      testValue += `${innerDecl}(`;\n      for (let j = 0; j < arraySize; j++) {\n        testValue += `${testScalarValue},`;\n      }\n      testValue += `),`;\n    }\n    testValue += ')';\n\n    const comparison = `\n    for ( var i = 0; i < ${arraySize}; i++) {\n      for ( var k = 0; k < ${arraySize}; k++) {\n        if (testVar[i][k] != ${testScalarValue}) {\n          atomicStore(&output.failed, 1u);\n        }\n      }\n    }\n    `;\n    const wgsl = generateShader(\n      t.params.type === 'f16',\n      t.params.addressSpace,\n      typeDecl,\n      testValue,\n      comparison\n    );\n\n    await run(t, wgsl);\n  });\n\ng.test('struct')\n  .desc(`Test that structs in private, and function storage classes can be initialized to a value.`)\n  .params(u => u.combine('addressSpace', ['private', 'function'] as const))\n  .fn(async t => {\n    let moduleScope = `\n    struct Output {\n      failed : atomic<u32>\n    }\n    @group(0) @binding(0) var<storage, read_write> output : Output;\n\n    struct A {\n        a: i32,\n        b: f32,\n    }\n\n    struct S {\n        c: f32,\n        d: A,\n        e: array<i32, 2>,\n    }\n  `;\n\n    const typeDecl = 'S';\n    const testValue = 'S(5.f, A(5i, 5.f), array<i32, 2>(5i, 5i))';\n\n    let functionScope = '';\n    switch (t.params.addressSpace) {\n      case 'private':\n        moduleScope += `\\nvar<private> testVar: ${typeDecl} = ${testValue};`;\n        break;\n      case 'function':\n        functionScope += `\\nvar testVar: ${typeDecl} = ${testValue};`;\n        break;\n    }\n\n    const comparison = `\n    if (testVar.c != 5f || testVar.d.a != 5i || testVar.d.b != 5.f || testVar.e[0] != 5i || testVar.e[1] != 5i) {\n      atomicStore(&output.failed, 1u);\n    }\n    `;\n\n    const wgsl = `\n      ${moduleScope}\n      @compute @workgroup_size(1, 1, 1)\n      fn main() {\n        ${functionScope}\n        ${comparison}\n      }\n    `;\n\n    await run(t, wgsl);\n  });\n"],"mappings":"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"}