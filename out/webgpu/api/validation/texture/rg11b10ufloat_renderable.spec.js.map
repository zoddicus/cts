{"version":3,"file":"rg11b10ufloat_renderable.spec.js","names":["description","makeTestGroup","GPUConst","ValidationTest","g","test","desc","params","u","combine","beforeAllSubcases","t","selectDeviceOrSkipTestCase","fn","sampleCount","descriptor","size","format","usage","TextureUsage","RENDER_ATTACHMENT","device","createTexture","texture","encoder","createCommandEncoder","pass","beginRenderPass","colorAttachments","view","createView","clearValue","r","b","a","loadOp","storeOp","end","finish","renderTexture","resolveTexture","resolveTarget","createRenderBundleEncoder","colorFormats","createRenderPipeline","layout","vertex","module","createShaderModule","code","getNoOpShaderCode","entryPoint","fragment","targets","writeMask","primitive","topology"],"sources":["../../../../../src/webgpu/api/validation/texture/rg11b10ufloat_renderable.spec.ts"],"sourcesContent":["export const description = `\nTests for capabilities added by rg11b10ufloat-renderable flag.\n`;\n\nimport { makeTestGroup } from '../../../../common/framework/test_group.js';\nimport { GPUConst } from '../../../constants.js';\nimport { ValidationTest } from '../validation_test.js';\n\nexport const g = makeTestGroup(ValidationTest);\n\ng.test('create_texture')\n  .desc(\n    `\nTest that it is valid to create rg11b10ufloat texture with RENDER_ATTACHMENT usage and/or\nsampleCount > 1, iff rg11b10ufloat-renderable feature is enabled.\nNote, the createTexture tests cover these validation cases where this feature is not enabled.\n`\n  )\n  .params(u => u.combine('sampleCount', [1, 4]))\n  .beforeAllSubcases(t => {\n    t.selectDeviceOrSkipTestCase('rg11b10ufloat-renderable');\n  })\n  .fn(t => {\n    const { sampleCount } = t.params;\n    const descriptor = {\n      size: [1, 1, 1],\n      format: 'rg11b10ufloat' as const,\n      sampleCount,\n      usage: GPUConst.TextureUsage.RENDER_ATTACHMENT,\n    };\n    t.device.createTexture(descriptor);\n  });\n\ng.test('begin_render_pass_single_sampled')\n  .desc(\n    `\nTest that it is valid to begin render pass with rg11b10ufloat texture format\niff rg11b10ufloat-renderable feature is enabled. Single sampled case.\n`\n  )\n  .beforeAllSubcases(t => {\n    t.selectDeviceOrSkipTestCase('rg11b10ufloat-renderable');\n  })\n  .fn(t => {\n    const texture = t.device.createTexture({\n      size: [1, 1, 1],\n      format: 'rg11b10ufloat',\n      sampleCount: 1,\n      usage: GPUConst.TextureUsage.RENDER_ATTACHMENT,\n    });\n    const encoder = t.device.createCommandEncoder();\n    const pass = encoder.beginRenderPass({\n      colorAttachments: [\n        {\n          view: texture.createView(),\n          clearValue: { r: 1.0, g: 0.0, b: 0.0, a: 1.0 },\n          loadOp: 'clear',\n          storeOp: 'store',\n        },\n      ],\n    });\n    pass.end();\n    encoder.finish();\n  });\n\ng.test('begin_render_pass_msaa_and_resolve')\n  .desc(\n    `\nTest that it is valid to begin render pass with rg11b10ufloat texture format\niff rg11b10ufloat-renderable feature is enabled. MSAA and resolve case.\n`\n  )\n  .beforeAllSubcases(t => {\n    t.selectDeviceOrSkipTestCase('rg11b10ufloat-renderable');\n  })\n  .fn(t => {\n    const renderTexture = t.device.createTexture({\n      size: [1, 1, 1],\n      format: 'rg11b10ufloat',\n      sampleCount: 4,\n      usage: GPUConst.TextureUsage.RENDER_ATTACHMENT,\n    });\n    const resolveTexture = t.device.createTexture({\n      size: [1, 1, 1],\n      format: 'rg11b10ufloat',\n      sampleCount: 1,\n      usage: GPUConst.TextureUsage.RENDER_ATTACHMENT,\n    });\n    const encoder = t.device.createCommandEncoder();\n    const pass = encoder.beginRenderPass({\n      colorAttachments: [\n        {\n          view: renderTexture.createView(),\n          resolveTarget: resolveTexture.createView(),\n          clearValue: { r: 1.0, g: 0.0, b: 0.0, a: 1.0 },\n          loadOp: 'clear',\n          storeOp: 'store',\n        },\n      ],\n    });\n    pass.end();\n    encoder.finish();\n  });\n\ng.test('begin_render_bundle_encoder')\n  .desc(\n    `\nTest that it is valid to begin render bundle encoder with rg11b10ufloat texture\nformat iff rg11b10ufloat-renderable feature is enabled.\n`\n  )\n  .beforeAllSubcases(t => {\n    t.selectDeviceOrSkipTestCase('rg11b10ufloat-renderable');\n  })\n  .fn(t => {\n    t.device.createRenderBundleEncoder({\n      colorFormats: ['rg11b10ufloat'],\n    });\n  });\n\ng.test('create_render_pipeline')\n  .desc(\n    `\nTest that it is valid to create render pipeline with rg11b10ufloat texture format\nin descriptor.fragment.targets iff rg11b10ufloat-renderable feature is enabled.\n`\n  )\n  .beforeAllSubcases(t => {\n    t.selectDeviceOrSkipTestCase('rg11b10ufloat-renderable');\n  })\n  .fn(t => {\n    t.device.createRenderPipeline({\n      layout: 'auto',\n      vertex: {\n        module: t.device.createShaderModule({\n          code: t.getNoOpShaderCode('VERTEX'),\n        }),\n        entryPoint: 'main',\n      },\n      fragment: {\n        module: t.device.createShaderModule({\n          code: t.getNoOpShaderCode('FRAGMENT'),\n        }),\n        entryPoint: 'main',\n        targets: [{ format: 'rg11b10ufloat', writeMask: 0 }],\n      },\n      primitive: { topology: 'triangle-list' },\n    });\n  });\n"],"mappings":"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"}