{"version":3,"file":"worker_launcher.js","names":["getDefaultRequestAdapterOptions","launchDedicatedWorker","selfPath","import","meta","url","selfPathDir","substring","lastIndexOf","workerPath","worker","Worker","type","promise","Promise","resolve","addEventListener","ev","data","once","postMessage","defaultRequestAdapterOptions","launchSharedWorker","SharedWorker","port","start"],"sources":["../../../../src/webgpu/web_platform/worker/worker_launcher.ts"],"sourcesContent":["import { getDefaultRequestAdapterOptions } from '../../../common/util/navigator_gpu.js';\n\nexport type TestResult = {\n  error: String | undefined;\n};\n\nexport async function launchDedicatedWorker() {\n  const selfPath = import.meta.url;\n  const selfPathDir = selfPath.substring(0, selfPath.lastIndexOf('/'));\n  const workerPath = selfPathDir + '/worker.js';\n  const worker = new Worker(workerPath, { type: 'module' });\n\n  const promise = new Promise<TestResult>(resolve => {\n    worker.addEventListener('message', ev => resolve(ev.data as TestResult), { once: true });\n  });\n  worker.postMessage({ defaultRequestAdapterOptions: getDefaultRequestAdapterOptions() });\n  return await promise;\n}\n\nexport async function launchSharedWorker() {\n  const selfPath = import.meta.url;\n  const selfPathDir = selfPath.substring(0, selfPath.lastIndexOf('/'));\n  const workerPath = selfPathDir + '/worker.js';\n  const worker = new SharedWorker(workerPath, { type: 'module' });\n\n  const port = worker.port;\n  const promise = new Promise<TestResult>(resolve => {\n    port.addEventListener('message', ev => resolve(ev.data as TestResult), { once: true });\n  });\n  port.start();\n  port.postMessage({\n    defaultRequestAdapterOptions: getDefaultRequestAdapterOptions(),\n  });\n  return await promise;\n}\n"],"mappings":";;GAAA,SAASA,+BAA+B,QAAQ,uCAAuC;;;;AAMvF,OAAO,eAAeC,qBAAqBA,CAAA,EAAG;EAC5C,MAAMC,QAAQ,GAAGC,MAAM,CAACC,IAAI,CAACC,GAAG;EAChC,MAAMC,WAAW,GAAGJ,QAAQ,CAACK,SAAS,CAAC,CAAC,EAAEL,QAAQ,CAACM,WAAW,CAAC,GAAG,CAAC,CAAC;EACpE,MAAMC,UAAU,GAAGH,WAAW,GAAG,YAAY;EAC7C,MAAMI,MAAM,GAAG,IAAIC,MAAM,CAACF,UAAU,EAAE,EAAEG,IAAI,EAAE,QAAQ,CAAC,CAAC,CAAC;;EAEzD,MAAMC,OAAO,GAAG,IAAIC,OAAO,CAAa,CAAAC,OAAO,KAAI;IACjDL,MAAM,CAACM,gBAAgB,CAAC,SAAS,EAAE,CAAAC,EAAE,KAAIF,OAAO,CAACE,EAAE,CAACC,IAAkB,CAAC,EAAE,EAAEC,IAAI,EAAE,IAAI,CAAC,CAAC,CAAC;EAC1F,CAAC,CAAC;EACFT,MAAM,CAACU,WAAW,CAAC,EAAEC,4BAA4B,EAAErB,+BAA+B,CAAC,CAAC,CAAC,CAAC,CAAC;EACvF,OAAO,MAAMa,OAAO;AACtB;;AAEA,OAAO,eAAeS,kBAAkBA,CAAA,EAAG;EACzC,MAAMpB,QAAQ,GAAGC,MAAM,CAACC,IAAI,CAACC,GAAG;EAChC,MAAMC,WAAW,GAAGJ,QAAQ,CAACK,SAAS,CAAC,CAAC,EAAEL,QAAQ,CAACM,WAAW,CAAC,GAAG,CAAC,CAAC;EACpE,MAAMC,UAAU,GAAGH,WAAW,GAAG,YAAY;EAC7C,MAAMI,MAAM,GAAG,IAAIa,YAAY,CAACd,UAAU,EAAE,EAAEG,IAAI,EAAE,QAAQ,CAAC,CAAC,CAAC;;EAE/D,MAAMY,IAAI,GAAGd,MAAM,CAACc,IAAI;EACxB,MAAMX,OAAO,GAAG,IAAIC,OAAO,CAAa,CAAAC,OAAO,KAAI;IACjDS,IAAI,CAACR,gBAAgB,CAAC,SAAS,EAAE,CAAAC,EAAE,KAAIF,OAAO,CAACE,EAAE,CAACC,IAAkB,CAAC,EAAE,EAAEC,IAAI,EAAE,IAAI,CAAC,CAAC,CAAC;EACxF,CAAC,CAAC;EACFK,IAAI,CAACC,KAAK,CAAC,CAAC;EACZD,IAAI,CAACJ,WAAW,CAAC;IACfC,4BAA4B,EAAErB,+BAA+B,CAAC;EAChE,CAAC,CAAC;EACF,OAAO,MAAMa,OAAO;AACtB"}