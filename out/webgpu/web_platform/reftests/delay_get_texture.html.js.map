{"version":3,"file":"delay_get_texture.html.js","names":["timeout","takeScreenshotDelayed","assert","condition","msg","Error","navigator","gpu","undefined","adapter","requestAdapter","device","requestDevice","canvas","document","getElementById","ctx","getContext","configure","format","getPreferredCanvasFormat","alphaMode","encoder","createCommandEncoder","pass","beginRenderPass","colorAttachments","view","getCurrentTexture","createView","clearValue","r","g","b","a","loadOp","storeOp","end","queue","submit","finish"],"sources":["../../../../src/webgpu/web_platform/reftests/delay_get_texture.html.ts"],"sourcesContent":["import { timeout } from '../../../common/util/timeout.js';\nimport { takeScreenshotDelayed } from '../../../common/util/wpt_reftest_wait.js';\n\nfunction assert(condition: boolean, msg?: string | (() => string)): asserts condition {\n  if (!condition) {\n    throw new Error(msg && (typeof msg === 'string' ? msg : msg()));\n  }\n}\n\nvoid (async () => {\n  assert(\n    typeof navigator !== 'undefined' && navigator.gpu !== undefined,\n    'No WebGPU implementation found'\n  );\n\n  const adapter = await navigator.gpu.requestAdapter();\n  assert(adapter !== null);\n  const device = await adapter.requestDevice();\n  assert(device !== null);\n\n  const canvas = document.getElementById('cvs0') as HTMLCanvasElement;\n  const ctx = canvas.getContext('webgpu') as unknown as GPUCanvasContext;\n  ctx.configure({\n    device,\n    format: navigator.gpu.getPreferredCanvasFormat(),\n    alphaMode: 'premultiplied',\n  });\n\n  timeout(() => {\n    const encoder = device.createCommandEncoder();\n    const pass = encoder.beginRenderPass({\n      colorAttachments: [\n        {\n          view: ctx.getCurrentTexture().createView(),\n          clearValue: { r: 0.0, g: 1.0, b: 0.0, a: 1.0 },\n          loadOp: 'clear',\n          storeOp: 'store',\n        },\n      ],\n    });\n    pass.end();\n    device.queue.submit([encoder.finish()]);\n\n    takeScreenshotDelayed(50);\n  }, 100);\n})();\n"],"mappings":";;GAAA,SAASA,OAAO,QAAQ,iCAAiC,CACzD,SAASC,qBAAqB,QAAQ,0CAA0C;AAEhF,SAASC,MAAMA,CAACC,SAAkB,EAAEC,GAA6B,EAAqB;EACpF,IAAI,CAACD,SAAS,EAAE;IACd,MAAM,IAAIE,KAAK,CAACD,GAAG,KAAK,OAAOA,GAAG,KAAK,QAAQ,GAAGA,GAAG,GAAGA,GAAG,CAAC,CAAC,CAAC,CAAC;EACjE;AACF;;AAEA,KAAK,CAAC,YAAY;EAChBF,MAAM;IACJ,OAAOI,SAAS,KAAK,WAAW,IAAIA,SAAS,CAACC,GAAG,KAAKC,SAAS;IAC/D;EACF,CAAC;;EAED,MAAMC,OAAO,GAAG,MAAMH,SAAS,CAACC,GAAG,CAACG,cAAc,CAAC,CAAC;EACpDR,MAAM,CAACO,OAAO,KAAK,IAAI,CAAC;EACxB,MAAME,MAAM,GAAG,MAAMF,OAAO,CAACG,aAAa,CAAC,CAAC;EAC5CV,MAAM,CAACS,MAAM,KAAK,IAAI,CAAC;;EAEvB,MAAME,MAAM,GAAGC,QAAQ,CAACC,cAAc,CAAC,MAAM,CAAsB;EACnE,MAAMC,GAAG,GAAGH,MAAM,CAACI,UAAU,CAAC,QAAQ,CAAgC;EACtED,GAAG,CAACE,SAAS,CAAC;IACZP,MAAM;IACNQ,MAAM,EAAEb,SAAS,CAACC,GAAG,CAACa,wBAAwB,CAAC,CAAC;IAChDC,SAAS,EAAE;EACb,CAAC,CAAC;;EAEFrB,OAAO,CAAC,MAAM;IACZ,MAAMsB,OAAO,GAAGX,MAAM,CAACY,oBAAoB,CAAC,CAAC;IAC7C,MAAMC,IAAI,GAAGF,OAAO,CAACG,eAAe,CAAC;MACnCC,gBAAgB,EAAE;MAChB;QACEC,IAAI,EAAEX,GAAG,CAACY,iBAAiB,CAAC,CAAC,CAACC,UAAU,CAAC,CAAC;QAC1CC,UAAU,EAAE,EAAEC,CAAC,EAAE,GAAG,EAAEC,CAAC,EAAE,GAAG,EAAEC,CAAC,EAAE,GAAG,EAAEC,CAAC,EAAE,GAAG,CAAC,CAAC;QAC9CC,MAAM,EAAE,OAAO;QACfC,OAAO,EAAE;MACX,CAAC;;IAEL,CAAC,CAAC;IACFZ,IAAI,CAACa,GAAG,CAAC,CAAC;IACV1B,MAAM,CAAC2B,KAAK,CAACC,MAAM,CAAC,CAACjB,OAAO,CAACkB,MAAM,CAAC,CAAC,CAAC,CAAC;;IAEvCvC,qBAAqB,CAAC,EAAE,CAAC;EAC3B,CAAC,EAAE,GAAG,CAAC;AACT,CAAC,EAAE,CAAC"}