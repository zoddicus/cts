{"version":3,"file":"utils_worker.js","names":["globalTestConfig","Logger","setDefaultRequestAdapterOptions","setupWorkerEnvironment","ctsOptions","debug","powerPreference","compatibility","unrollConstEvalLoops","logToWebSocket","globalDebugMode","log","compatibilityMode"],"sources":["../../../../src/common/runtime/helper/utils_worker.ts"],"sourcesContent":["import { globalTestConfig } from '../../framework/test_config.js';\nimport { Logger } from '../../internal/logging/logger.js';\nimport { TestQueryWithExpectation } from '../../internal/query/query.js';\nimport { setDefaultRequestAdapterOptions } from '../../util/navigator_gpu.js';\n\nimport { CTSOptions } from './options.js';\n\nexport interface WorkerTestRunRequest {\n  query: string;\n  expectations: TestQueryWithExpectation[];\n  ctsOptions: CTSOptions;\n}\n\n/**\n * Set config environment for workers with ctsOptions and return a Logger.\n */\nexport function setupWorkerEnvironment(ctsOptions: CTSOptions): Logger {\n  const { debug, powerPreference, compatibility } = ctsOptions;\n  globalTestConfig.unrollConstEvalLoops = ctsOptions.unrollConstEvalLoops;\n  globalTestConfig.compatibility = compatibility;\n  globalTestConfig.logToWebSocket = ctsOptions.logToWebSocket;\n\n  Logger.globalDebugMode = debug;\n  const log = new Logger();\n\n  if (powerPreference || compatibility) {\n    setDefaultRequestAdapterOptions({\n      ...(powerPreference && { powerPreference }),\n      // MAINTENANCE_TODO: Change this to whatever the option ends up being\n      ...(compatibility && { compatibilityMode: true }),\n    });\n  }\n\n  return log;\n}\n"],"mappings":";;GAAA,SAASA,gBAAgB,QAAQ,gCAAgC,CACjE,SAASC,MAAM,QAAQ,kCAAkC;AAEzD,SAASC,+BAA+B,QAAQ,6BAA6B;;;;;;;;;;AAU7E;AACA;AACA;AACA,OAAO,SAASC,sBAAsBA,CAACC,UAAsB,EAAU;EACrE,MAAM,EAAEC,KAAK,EAAEC,eAAe,EAAEC,aAAa,CAAC,CAAC,GAAGH,UAAU;EAC5DJ,gBAAgB,CAACQ,oBAAoB,GAAGJ,UAAU,CAACI,oBAAoB;EACvER,gBAAgB,CAACO,aAAa,GAAGA,aAAa;EAC9CP,gBAAgB,CAACS,cAAc,GAAGL,UAAU,CAACK,cAAc;;EAE3DR,MAAM,CAACS,eAAe,GAAGL,KAAK;EAC9B,MAAMM,GAAG,GAAG,IAAIV,MAAM,CAAC,CAAC;;EAExB,IAAIK,eAAe,IAAIC,aAAa,EAAE;IACpCL,+BAA+B,CAAC;MAC9B,IAAII,eAAe,IAAI,EAAEA,eAAe,CAAC,CAAC,CAAC;MAC3C;MACA,IAAIC,aAAa,IAAI,EAAEK,iBAAiB,EAAE,IAAI,CAAC,CAAC;IAClD,CAAC,CAAC;EACJ;;EAEA,OAAOD,GAAG;AACZ"}